<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BYOD Access Architecture - Threat Model</title>
    <script>document.documentElement.classList.remove('no-js');</script>
    <style>
        :root {
            --green: #28a745;
            --red: #dc3545;
            --yellow: #ffc107;
            --dark: #2c3e50;
            --light-gray: #f8f9fa;
            --border: #dee2e6;
            --sidebar-width: 280px;
            --sidebar-bg: #1a252f;
            --sidebar-text: #ecf0f1;
            --sidebar-hover: #34495e;
            --sidebar-active: #3498db;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #fff;
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* ========== LEFT SIDEBAR ========== */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--sidebar-bg);
            color: var(--sidebar-text);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-header h2 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
        }
        
        .sidebar-header .subtitle {
            font-size: 0.75rem;
            color: #95a5a6;
            margin-top: 5px;
        }

        /* Sidebar Navigation */
        .sidebar-nav {
            padding: 10px 0;
        }
        
        .nav-section {
            margin-bottom: 5px;
        }
        
        .nav-section-header {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s;
            user-select: none;
        }
        
        .nav-section-header:hover {
            background: var(--sidebar-hover);
        }
        
        .nav-section-header.active {
            background: var(--sidebar-active);
        }
        
        .nav-toggle {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            transition: transform 0.2s;
        }
        
        .nav-toggle svg {
            width: 12px;
            height: 12px;
            fill: currentColor;
        }
        
        .nav-section.expanded .nav-toggle {
            transform: rotate(90deg);
        }
        
        .nav-section-title {
            flex: 1;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .nav-section-content {
            display: none;
            background: rgba(0,0,0,0.2);
        }
        
        .nav-section.expanded .nav-section-content {
            display: block;
        }
        
        .nav-item {
            display: block;
            padding: 10px 20px 10px 50px;
            color: #bdc3c7;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: var(--sidebar-hover);
            color: #fff;
        }
        
        .nav-item.active {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: var(--sidebar-active);
            color: #fff;
        }
        
        /* Sub-items (threats, etc.) */
        .nav-sub-section {
            margin-left: 20px;
        }
        
        .nav-sub-header {
            display: flex;
            align-items: center;
            padding: 8px 20px 8px 30px;
            cursor: pointer;
            font-size: 0.82rem;
            color: #95a5a6;
            transition: color 0.2s;
        }
        
        .nav-sub-header:hover {
            color: #fff;
        }
        
        .nav-sub-toggle {
            width: 16px;
            margin-right: 8px;
            font-size: 0.7rem;
        }
        
        .nav-sub-items {
            display: none;
        }
        
        .nav-sub-section.expanded .nav-sub-items {
            display: block;
        }
        
        .nav-sub-item {
            display: block;
            padding: 6px 20px 6px 58px;
            color: #7f8c8d;
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        
        .nav-sub-item:hover {
            color: #fff;
            background: var(--sidebar-hover);
        }
        
        /* Threat Type Groups */
        .nav-threat-group {
            margin-left: 0;
        }
        
        .nav-threat-group-header {
            display: flex;
            align-items: center;
            padding: 8px 20px 8px 35px;
            cursor: pointer;
            font-size: 0.82rem;
            color: #95a5a6;
            transition: all 0.2s;
            user-select: none;
        }
        
        .nav-threat-group-header:hover {
            color: #fff;
            background: var(--sidebar-hover);
        }
        
        .nav-threat-group.expanded > .nav-threat-group-header {
            color: #fff;
            background: rgba(52, 152, 219, 0.15);
        }
        
        .nav-threat-group-toggle {
            width: 14px;
            height: 14px;
            margin-right: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }
        
        .nav-threat-group-toggle svg {
            width: 10px;
            height: 10px;
            fill: currentColor;
        }
        
        .nav-threat-group.expanded .nav-threat-group-toggle {
            transform: rotate(90deg);
        }
        
        .nav-threat-group-title {
            flex: 1;
            font-weight: 500;
        }
        
        .nav-threat-group-count {
            font-size: 0.7rem;
            background: rgba(255,255,255,0.1);
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 8px;
        }
        
        .nav-threat-group-items {
            display: none;
            background: rgba(0,0,0,0.15);
        }
        
        .nav-threat-group.expanded .nav-threat-group-items {
            display: block;
        }
        
        .nav-threat-item {
            display: flex;
            align-items: center;
            padding: 6px 20px 6px 50px;
            color: #7f8c8d;
            text-decoration: none;
            font-size: 0.78rem;
            transition: all 0.2s;
            border-left: 2px solid transparent;
        }
        
        .nav-threat-item:hover {
            color: #fff;
            background: var(--sidebar-hover);
        }
        
        .nav-threat-item.active {
            color: #fff;
            border-left-color: var(--sidebar-active);
            background: rgba(52, 152, 219, 0.1);
        }
        
        /* Threat Model Selection */
        .model-list {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding: 10px 0;
        }
        
        .model-item-link {
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .model-item {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s;
            color: var(--sidebar-text);
        }
        
        .model-item:hover {
            background: var(--sidebar-hover);
        }
        
        .model-item.current {
            background: var(--sidebar-active);
            cursor: default;
        }
        
        .model-icon {
            width: 24px;
            height: 24px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .model-item.current .model-icon {
            background: rgba(255,255,255,0.2);
        }
        
        .model-name {
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* ========== MAIN CONTENT ========== */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 30px 40px;
            min-height: 100vh;
            max-width: calc(100vw - var(--sidebar-width));
            overflow-x: hidden;
        }
        
        .content-section {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .diagram-section {
            width: 100%;
            overflow: visible;
        }
        
        /* Header */
        .header {
            border-bottom: 3px solid var(--dark);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2rem;
            color: var(--dark);
        }
        
        .header .meta {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        /* Remove old top nav */
        .nav {
            display: none;
        }
        
        /* Sections */
        section {
            margin-bottom: 40px;
            padding-top: 20px;
        }
        
        section h2 {
            font-size: 1.5rem;
            color: var(--dark);
            border-bottom: 2px solid var(--dark);
            padding-bottom: 8px;
            margin-bottom: 20px;
        }
        
        section h3 {
            font-size: 1.2rem;
            color: #444;
            margin: 25px 0 15px 0;
            border-bottom: 1px solid var(--border);
            padding-bottom: 5px;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border);
        }
        
        th {
            background: var(--dark);
            color: white;
            font-weight: 600;
        }
        
        tr:nth-child(even) { background: var(--light-gray); }
        tr:hover { background: #e9ecef; }
        
        /* Status indicators */
        .status-icon {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .status-mitigated { color: var(--green); }
        .status-unmitigated { color: var(--red); }
        
        .cvss {
            font-family: monospace;
            font-size: 0.85rem;
            background: #eee;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        .cvss-high { background: #f8d7da; color: #721c24; }
        .cvss-medium { background: #fff3cd; color: #856404; }
        .cvss-low { background: #d4edda; color: #155724; }
        
        /* Links */
        a { color: #0066cc; }
        a:hover { color: #004499; }
        
        /* Scope content */
        .scope-text {
            background: var(--light-gray);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--dark);
        }
        
        /* Attack Tree Legend */
        .attack-tree-legend {
            background: var(--light-gray);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px 20px;
            margin-bottom: 15px;
        }
        
        .legend-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid #333;
        }
        
        .legend-edges {
            font-size: 0.85rem;
            color: #666;
            display: flex;
            gap: 30px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid var(--border);
        }
        
        /* Diagrams */
        .diagram-container {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 40px 20px;
            margin: 15px 0;
            overflow-x: auto;
            overflow-y: visible;
            width: 100%;
            max-width: 100%;
        }
        
        .attack-tree-container {
            min-height: 400px;
        }
        
        .mermaid {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
            max-width: 100%;
        }
        
        .mermaid svg {
            max-width: 100%;
            width: auto !important;
            height: auto !important;
            display: block;
            transform-origin: top left;
        }
        
        /* PlantUML Styles */
        .diagram-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .diagram-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 0;
            border-bottom: 2px solid var(--border);
            padding-bottom: 0;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            font-size: 0.9rem;
            border-radius: 6px 6px 0 0;
            transition: all 0.2s;
            color: #666;
        }
        
        .tab-btn:hover {
            background: #e0e0e0;
        }
        
        .tab-btn.active {
            background: #fff;
            color: var(--dark);
            font-weight: 600;
            border: 2px solid var(--border);
            border-bottom: 2px solid #fff;
            margin-bottom: -2px;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background: #fff;
            border: 1px solid var(--border);
            border-top: none;
            border-radius: 0 0 6px 6px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .plantuml-container {
            background: #fff;
            padding: 20px;
            overflow-x: auto;
            text-align: center;
        }
        
        .plantuml-diagram {
            max-width: 100%;
            height: auto;
        }
        
        .puml-source-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .source-tab-btn {
            padding: 8px 15px;
            border: 1px solid var(--border);
            background: #f8f9fa;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.85rem;
        }
        
        .source-tab-btn.active {
            background: var(--dark);
            color: #fff;
            border-color: var(--dark);
        }
        
        .source-content {
            display: none;
        }
        
        .source-content.active {
            display: block;
        }
        
        .puml-source {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .copy-btn {
            margin-top: 10px;
            padding: 8px 16px;
            background: var(--sidebar-active);
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        .copy-btn:hover {
            background: #2980b9;
        }
        
        .puml-legend {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid var(--border);
        }
        
        .puml-legend h4 {
            margin: 0 0 10px 0;
            font-size: 0.95rem;
            color: var(--dark);
        }
        
        .puml-legend .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .puml-legend .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }
        
        .puml-legend .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .puml-legend .legend-color.critical { background: #FF6B6B; }
        .puml-legend .legend-color.high { background: #FFA500; }
        .puml-legend .legend-color.medium { background: #FFD93D; }
        .puml-legend .legend-color.low { background: #6BCB77; }
        
        .puml-legend .legend-arrow {
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .puml-legend .legend-arrow.red { color: #FF0000; }
        .puml-legend .legend-arrow.orange { color: #FFA500; }
        
        /* Threat Cards */
        .threat-card {
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 40px;
            overflow: hidden;
            transition: box-shadow 0.3s ease, border-color 0.3s ease;
        }
        
        .threat-card.highlight {
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
            border-color: var(--sidebar-active);
        }
        
        @keyframes highlight-pulse {
            0%, 100% { box-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
            50% { box-shadow: 0 0 25px rgba(52, 152, 219, 0.6); }
        }
        
        .threat-card.highlight {
            animation: highlight-pulse 0.5s ease-in-out 3;
        }
        
        .threat-card-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
        }
        
        .threat-card-header h4 {
            margin: 0;
            font-size: 1.3rem;
            color: #333;
        }
        
        .threat-card-header .threat-id {
            color: var(--red);
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .threat-card-body {
            display: flex;
            gap: 30px;
            padding: 20px;
        }
        
        .threat-details {
            flex: 1;
            min-width: 0;
        }
        
        .threat-diagram {
            width: 400px;
            flex-shrink: 0;
        }
        
        /* Detail rows */
        .detail-row {
            margin-bottom: 15px;
        }
        
        .detail-label {
            font-weight: 600;
            color: #555;
            font-size: 0.85rem;
            margin-bottom: 4px;
        }
        
        .detail-value {
            font-size: 0.95rem;
        }
        
        .detail-value.mitigated {
            color: var(--green);
            font-weight: 600;
        }
        
        .detail-value.unmitigated {
            color: var(--red);
            font-weight: 600;
        }
        
        /* Security objective tags */
        .sec-obj-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 5px;
        }
        
        .sec-obj-tag {
            background: #f0f0f0;
            border: 1px solid #ccc;
            padding: 2px 8px;
            font-size: 0.75rem;
            font-family: monospace;
            border-radius: 3px;
        }
        
        /* CVSS section */
        .cvss-section {
            background: var(--light-gray);
            padding: 10px 15px;
            border-radius: 6px;
            margin-top: 10px;
        }
        
        .cvss-score {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .cvss-vector {
            font-family: monospace;
            font-size: 0.8rem;
            color: #666;
            word-break: break-all;
        }
        
        /* Countermeasures section */
        .cm-section {
            margin-top: 25px;
            border-top: 2px solid var(--dark);
            padding-top: 15px;
        }
        
        .cm-section h5 {
            font-size: 1rem;
            color: var(--dark);
            margin-bottom: 15px;
        }
        
        .cm-item {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 12px;
        }
        
        .cm-item.implemented {
            border-left: 4px solid var(--green);
        }
        
        .cm-item.not-implemented {
            border-left: 4px solid var(--yellow);
        }
        
        .cm-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .cm-id {
            font-family: monospace;
            font-size: 0.8rem;
            color: var(--red);
            background: #fff0f0;
            padding: 2px 6px;
            border-radius: 3px;
            margin-right: 10px;
        }
        
        .cm-title {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .cm-desc {
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 10px;
        }
        
        .cm-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .cm-status-label {
            color: #666;
        }
        
        .cm-status-value {
            font-weight: 600;
        }
        
        .cm-status-value.yes {
            color: var(--green);
        }
        
        .cm-status-value.no {
            color: var(--red);
        }
        
        /* Visual diagram styles */
        .visual-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .vt-node {
            text-align: center;
            padding: 12px 15px;
            border-radius: 6px;
            font-size: 0.85rem;
            max-width: 350px;
        }
        
        .vt-threat {
            background: #fff;
            border: 2px solid var(--red);
        }
        
        .vt-threat-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
        }
        
        .vt-threat .sec-obj-tags {
            justify-content: center;
        }
        
        .vt-attack {
            background: #fff5f5;
            border: 1px solid #f5c6cb;
        }
        
        .vt-attack-label {
            font-weight: 600;
            font-size: 0.8rem;
            color: var(--red);
            margin-bottom: 5px;
        }
        
        .vt-connector {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 0;
        }
        
        .vt-line {
            width: 2px;
            height: 20px;
            background: #999;
        }
        
        .vt-label {
            font-size: 0.75rem;
            color: #666;
            font-style: italic;
        }
        
        /* Countermeasures row */
        .vt-cm-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 5px;
        }
        
        .vt-cm {
            background: #e8f5e9;
            border: 1px solid var(--green);
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
            min-width: 120px;
        }
        
        .vt-cm.not-impl {
            background: #fff8e1;
            border-color: var(--yellow);
        }
        
        .vt-cm-label {
            font-size: 0.7rem;
            color: #666;
            margin-bottom: 3px;
        }
        
        .vt-cm-title {
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        /* Mitigates connector for multiple CMs */
        .vt-mitigates-row {
            display: flex;
            justify-content: center;
            gap: 10px;
            position: relative;
        }
        
        .vt-mitigates-row::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: #999;
        }
        
        .vt-mitigate-line {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .vt-mitigate-line .vt-line {
            height: 15px;
        }
        
        @media (max-width: 1100px) {
            .sidebar {
                width: 240px;
            }
            :root {
                --sidebar-width: 240px;
            }
            .threat-card-body {
                flex-direction: column;
            }
            .threat-diagram {
                width: 100%;
            }
        }
        
        @media (max-width: 900px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .main-content {
                margin-left: 0;
            }
            body {
                flex-direction: column;
            }
        }
        
        /* Footer */
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: #666;
            font-size: 0.85rem;
        }
        
        /* Affected Assets badges in threat cards */
        .affected-assets {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 5px;
        }
        
        .affected-asset-badge {
            background: #e3f2fd;
            color: #1565c0;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid #90caf9;
        }
        
        /* ========== ASSET SECTION STYLES ========== */
        .asset-section {
            border-left: 4px solid #3498db;
            padding-left: 20px;
            margin-bottom: 50px;
        }
        
        .asset-section h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .asset-icon {
            font-size: 1.3rem;
        }
        
        .asset-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .asset-type-badge {
            background: #3498db;
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .asset-zone-badge {
            background: #9b59b6;
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .asset-threat-count {
            background: var(--light-gray);
            color: #666;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            border: 1px solid var(--border);
        }
        
        .asset-description {
            background: var(--light-gray);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            color: #555;
        }
        
        .asset-threats-table {
            width: 100%;
            margin-top: 15px;
        }
        
        .asset-threats-table tbody tr:hover {
            background: #e3f2fd !important;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-badge.mitigated {
            background: #d4edda;
            color: #155724;
        }
        
        .status-badge.unmitigated {
            background: #f8d7da;
            color: #721c24;
        }
        
        .no-threats-message {
            color: #666;
            font-style: italic;
            padding: 20px;
            text-align: center;
            background: var(--light-gray);
            border-radius: 6px;
        }
        
        .cvss-critical {
            background: #8B0000 !important;
            color: #fff !important;
        }
        
        /* ========== SECURITY TESTING STYLES ========== */
        .testing-section {
            border-left: 4px solid #9c27b0;
            padding-left: 20px;
            margin-bottom: 50px;
        }
        
        .testing-section h2 {
            color: #7b1fa2;
        }
        
        .testing-intro {
            background: #f3e5f5;
            border: 1px solid #e1bee7;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        
        .test-case-card {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .test-case-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #fafafa;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
        }
        
        .test-case-header:hover {
            background: #f0f0f0;
        }
        
        .test-case-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-case-title h4 {
            margin: 0;
            font-size: 1rem;
        }
        
        .test-case-id {
            font-family: monospace;
            font-size: 0.8rem;
            background: #9c27b0;
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
        }
        
        .test-status-select {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
        }
        
        .test-status-select.not-tested { background: #f5f5f5; }
        .test-status-select.passed { background: #c8e6c9; color: #2e7d32; }
        .test-status-select.failed { background: #ffcdd2; color: #c62828; }
        .test-status-select.in-progress { background: #fff9c4; color: #f57f17; }
        
        .test-case-body {
            padding: 20px;
        }
        
        .test-objective {
            margin-bottom: 15px;
        }
        
        .test-objective-label {
            font-weight: 600;
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .test-steps {
            background: #fafafa;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .test-steps h5 {
            margin: 0 0 10px 0;
            font-size: 0.9rem;
            color: #333;
        }
        
        .test-steps ol {
            margin: 0;
            padding-left: 20px;
        }
        
        .test-steps li {
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .test-expected {
            background: #e8f5e9;
            border: 1px solid #c8e6c9;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .test-expected h5 {
            margin: 0 0 8px 0;
            font-size: 0.9rem;
            color: #2e7d32;
        }
        
        .test-tools {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .test-tool-tag {
            background: #e1bee7;
            color: #7b1fa2;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .test-notes {
            margin-top: 15px;
        }
        
        .test-notes textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.9rem;
            resize: vertical;
        }
        
        .test-prerequisites {
            background: #fff3e0;
            border: 1px solid #ffe0b2;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .test-prerequisites h5 {
            margin: 0 0 8px 0;
            font-size: 0.9rem;
            color: #e65100;
        }
        
        .test-prerequisites ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .test-script {
            background: #263238;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
        }
        
        .test-script-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .test-script-language {
            color: #4fc3f7;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .test-script-copy {
            background: #37474f;
            color: #fff;
            border: none;
            padding: 4px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background 0.2s;
        }
        
        .test-script-copy:hover {
            background: #455a64;
        }
        
        .test-script-copy.copied {
            background: #4caf50;
        }
        
        .test-script-description {
            color: #90a4ae;
            font-size: 0.85rem;
            margin-bottom: 10px;
            font-style: italic;
        }
        
        .test-script pre {
            margin: 0;
            padding: 0;
            background: transparent;
            overflow-x: auto;
        }
        
        .test-script code {
            color: #b0bec5;
            font-family: 'Courier New', Consolas, Monaco, monospace;
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        .test-script-requirements {
            color: #78909c;
            font-size: 0.8rem;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #37474f;
        }
        
        .test-behavior {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .test-behavior-vulnerable,
        .test-behavior-mitigated {
            border-radius: 6px;
            padding: 15px;
        }
        
        .test-behavior-vulnerable {
            background: #ffebee;
            border: 1px solid #ffcdd2;
        }
        
        .test-behavior-vulnerable h5 {
            margin: 0 0 8px 0;
            font-size: 0.9rem;
            color: #c62828;
        }
        
        .test-behavior-mitigated {
            background: #e8f5e9;
            border: 1px solid #c8e6c9;
        }
        
        .test-behavior-mitigated h5 {
            margin: 0 0 8px 0;
            font-size: 0.9rem;
            color: #2e7d32;
        }
        
        .testing-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .testing-stat {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .testing-stat-value {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .testing-stat-label {
            font-size: 0.85rem;
            color: #666;
        }
        
        .testing-stat.total .testing-stat-value { color: #333; }
        .testing-stat.passed .testing-stat-value { color: #2e7d32; }
        .testing-stat.failed .testing-stat-value { color: #c62828; }
        .testing-stat.pending .testing-stat-value { color: #f57f17; }

        /* Static diagram container for simple non-interactive diagrams */
        .static-diagram {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .static-diagram .mermaid {
            display: flex;
            justify-content: center;
        }
        
        .static-diagram .mermaid svg {
            max-width: 100%;
            height: auto;
        }

        /* Print Mode Toggle Button */
        .print-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            gap: 8px;
            align-items: center;
            background: var(--dark);
            color: #fff;
            padding: 12px 18px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border: none;
        }
        
        .print-mode-toggle:hover {
            background: #1a252f;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
        
        .print-mode-toggle svg {
            width: 18px;
            height: 18px;
        }
        
        .print-mode-toggle.active {
            background: var(--green);
        }
        
        .print-mode-indicator {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--green);
            color: #fff;
            text-align: center;
            padding: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            z-index: 10000;
            display: none;
        }
        
        .print-mode-indicator .print-actions {
            margin-left: 20px;
        }
        
        .print-mode-indicator button {
            background: #fff;
            color: var(--green);
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            font-weight: 600;
        }
        
        .print-mode-indicator button:hover {
            background: #f0f0f0;
        }
        
        .print-mode-indicator button.exit-btn {
            background: transparent;
            color: #fff;
            border: 1px solid #fff;
        }
        
        /* ========== PRINT/PDF MODE STYLES ========== */
        body.print-mode {
            display: block;
        }
        
        body.print-mode .sidebar {
            display: none !important;
        }
        
        body.print-mode .main-content {
            margin-left: 0 !important;
            max-width: 100% !important;
            padding: 20px 40px;
        }
        
        body.print-mode .print-mode-toggle {
            display: none;
        }
        
        body.print-mode .print-mode-indicator {
            display: block;
        }
        
        /* Expand all collapsible sections in print mode */
        body.print-mode .nav-section,
        body.print-mode .nav-threat-group,
        body.print-mode .nav-sub-section {
            display: block !important;
        }
        
        body.print-mode .nav-section-content,
        body.print-mode .nav-threat-group-items,
        body.print-mode .nav-sub-items {
            display: block !important;
        }
        
        /* Hide interactive controls in print mode */
        body.print-mode .diagram-toolbar {
            display: none !important;
        }
        
        body.print-mode .diagram-hint {
            display: none !important;
        }
        
        body.print-mode .toolbar-btn {
            display: none !important;
        }
        
        body.print-mode .fullscreen-close {
            display: none !important;
        }
        
        body.print-mode .tab-btn {
            pointer-events: none;
        }
        
        /* Show all tab contents in print mode */
        body.print-mode .tab-content {
            display: block !important;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            page-break-inside: avoid;
            page-break-before: always;
        }
        
        body.print-mode .tab-content::before {
            content: attr(data-tab-name);
            display: block;
            font-weight: 600;
            padding: 10px 15px;
            background: var(--light-gray);
            border-bottom: 1px solid var(--border);
        }
        
        body.print-mode .diagram-tabs {
            display: none;
        }
        
        /* Hide UML source code in print mode */
        body.print-mode .tab-content#puml-source {
            display: none !important;
        }
        
        /* Ensure diagrams are visible and static in print mode */
        body.print-mode .interactive-diagram {
            page-break-inside: avoid;
            margin: 0 auto;
        }
        
        body.print-mode .diagram-viewport {
            overflow: visible !important;
            max-height: none !important;
            cursor: default !important;
            border: none;
        }
        
        body.print-mode .diagram-canvas {
            transform: none !important;
            display: flex;
            justify-content: center;
        }
        
        /* Full width for diagrams in print mode */
        body.print-mode .mermaid svg {
            max-width: 100% !important;
            height: auto !important;
        }
        
        /* Ensure PlantUML images are visible and fit for print */
        body.print-mode .plantuml-diagram {
            max-width: 100% !important;
            max-height: 95vh !important; /* Force fit to page height */
            width: auto !important;
            height: auto !important;
            display: block;
            margin: 0 auto;
        }
        
        /* Larger viewport for PlantUML diagrams in print mode */
        body.print-mode .diagram-viewport {
            min-height: auto !important;
        }
        
        /* Page breaks for PDF generation */
        body.print-mode section {
            page-break-inside: avoid;
        }
        
        body.print-mode .threat-card {
            page-break-inside: avoid;
            margin-bottom: 30px;
        }
        
        body.print-mode h2 {
            page-break-after: avoid;
        }
        
        body.print-mode h3 {
            page-break-after: avoid;
        }
        
        body.print-mode table {
            page-break-inside: avoid;
        }
        
        /* Print mode for Testing section */
        body.print-mode .testing-section {
            page-break-before: always;
        }
        
        body.print-mode .test-case-card {
            page-break-inside: avoid;
            margin-bottom: 20px;
        }
        
        body.print-mode .test-case-body {
            display: block !important;
        }
        
        body.print-mode .test-status-select {
            display: none;
        }
        
        body.print-mode .testing-summary {
            display: none;
        }
        
        body.print-mode .test-notes {
            display: none;
        }
        
        body.print-mode .review-checklist input[type="checkbox"] {
            print-color-adjust: exact;
            -webkit-print-color-adjust: exact;
        }

        /* Print styles for actual printing */
        @media print {
            .sidebar { display: none !important; }
            .main-content { margin-left: 0 !important; }
            body { display: block !important; }
            section { page-break-inside: avoid; }
            .print-mode-toggle { display: none !important; }
            .print-mode-indicator { display: none !important; }
            .diagram-toolbar { display: none !important; }
            .diagram-hint { display: none !important; }
            .toolbar-btn { display: none !important; }
            .fullscreen-close { display: none !important; }
            .tab-btn { display: none !important; }
            .tab-content { 
                display: block !important;
                page-break-inside: avoid;
            }
            .tab-content#puml-source {
                display: none !important;
            }
            .diagram-tabs { display: none !important; }
            .diagram-viewport {
                overflow: visible !important;
                max-height: none !important;
            }
            .diagram-canvas {
                transform: none !important;
            }
            .threat-card {
                page-break-inside: avoid;
            }
            .interactive-diagram {
                page-break-inside: avoid;
            }
        }
        
        
/* ========== INTERACTIVE DIAGRAM STYLES ========== */
.interactive-diagram {
    position: relative;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: #fafafa;
    margin: 15px 0;
    overflow: hidden;
}

.interactive-diagram .diagram-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
    gap: 8px;
}

.interactive-diagram .diagram-toolbar-left,
.interactive-diagram .diagram-toolbar-center,
.interactive-diagram .diagram-toolbar-right {
    display: flex;
    align-items: center;
    gap: 6px;
}

.interactive-diagram .diagram-title-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--dark);
}

.interactive-diagram .toolbar-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    background: #fff;
    cursor: pointer;
    color: #495057;
    transition: all 0.15s ease;
}

.interactive-diagram .toolbar-btn:hover {
    background: #e9ecef;
    border-color: #adb5bd;
}

.interactive-diagram .toolbar-btn:active {
    background: #dee2e6;
    transform: scale(0.95);
}

.interactive-diagram .toolbar-btn.active {
    background: var(--sidebar-active);
    color: #fff;
    border-color: var(--sidebar-active);
}

.interactive-diagram .toolbar-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.interactive-diagram .zoom-level {
    font-size: 0.8rem;
    color: #6c757d;
    min-width: 50px;
    text-align: center;
    user-select: none;
    font-family: monospace;
}

.interactive-diagram .diagram-viewport {
    position: relative;
    width: 100%;
    min-height: 400px;
    max-height: 70vh;
    overflow: hidden;
    cursor: grab;
    background: 
        linear-gradient(90deg, #f5f5f5 1px, transparent 1px),
        linear-gradient(#f5f5f5 1px, transparent 1px);
    background-size: 20px 20px;
    background-color: #fff;
}

.interactive-diagram .diagram-viewport.grabbing {
    cursor: grabbing;
}

.interactive-diagram .diagram-viewport.fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    max-height: 100vh;
    z-index: 9999;
    background: #fff;
    border-radius: 0;
}

.interactive-diagram .diagram-canvas {
    transform-origin: 0 0;
    transition: none;
    will-change: transform;
    display: inline-block;
    padding: 20px;
}

/* SVG rendering quality improvements */
.interactive-diagram .diagram-canvas svg {
    shape-rendering: geometricPrecision;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.interactive-diagram .diagram-canvas svg text {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 14px;
}

.interactive-diagram .diagram-canvas svg .nodeLabel,
.interactive-diagram .diagram-canvas svg .label {
    font-size: 13px;
    font-weight: 500;
}

.interactive-diagram .diagram-canvas svg .edgeLabel {
    font-size: 11px;
}

/* Mermaid diagram specific improvements */
.interactive-diagram .mermaid svg {
    min-width: 100%;
    height: auto;
}

.interactive-diagram .diagram-canvas.animating {
    transition: transform 0.2s ease-out;
}

/* SVG hover effects for nodes */
.interactive-diagram .diagram-canvas svg .node:hover,
.interactive-diagram .diagram-canvas svg g[id^="flowchart-"]:hover,
.interactive-diagram .diagram-canvas svg g[id^="T_"]:hover,
.interactive-diagram .diagram-canvas svg g[id^="A_"]:hover,
.interactive-diagram .diagram-canvas svg g[id^="M_"]:hover {
    filter: drop-shadow(0 0 8px rgba(52, 152, 219, 0.6));
    cursor: pointer;
}

.interactive-diagram .diagram-canvas svg .node rect,
.interactive-diagram .diagram-canvas svg .node circle,
.interactive-diagram .diagram-canvas svg .node ellipse,
.interactive-diagram .diagram-canvas svg .node polygon {
    transition: stroke-width 0.15s ease;
}

.interactive-diagram .diagram-canvas svg .node:hover rect,
.interactive-diagram .diagram-canvas svg .node:hover circle,
.interactive-diagram .diagram-canvas svg .node:hover ellipse,
.interactive-diagram .diagram-canvas svg .node:hover polygon {
    stroke-width: 3px;
}

/* Diagram tooltip */
.diagram-tooltip {
    position: fixed;
    z-index: 10000;
    padding: 10px 14px;
    background: rgba(44, 62, 80, 0.95);
    color: #fff;
    border-radius: 6px;
    font-size: 0.85rem;
    line-height: 1.4;
    max-width: 320px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s ease;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.diagram-tooltip.visible {
    opacity: 1;
}

.diagram-tooltip .tooltip-title {
    font-weight: 600;
    margin-bottom: 4px;
    color: #3498db;
}

.diagram-tooltip .tooltip-meta {
    font-size: 0.78rem;
    color: #bdc3c7;
}

/* PlantUML image quality */
.interactive-diagram .plantuml-diagram {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    max-width: none;
    height: auto;
    min-height: 400px;
}

/* Print mode enhancements for PlantUML */
body.print-mode .interactive-diagram .plantuml-diagram {
    min-height: 600px;
    width: 100%;
    object-fit: contain;
    image-rendering: high-quality;
}

/* Fullscreen close button */
.interactive-diagram .fullscreen-close {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10001;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: #e74c3c;
    color: #fff;
    border: none;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    transition: background 0.15s ease;
}

.interactive-diagram .fullscreen-close:hover {
    background: #c0392b;
}

.interactive-diagram .diagram-viewport.fullscreen ~ .fullscreen-close {
    display: flex;
}

/* Hint text */
.interactive-diagram .diagram-hint {
    position: absolute;
    bottom: 8px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.75rem;
    color: #999;
    background: rgba(255,255,255,0.9);
    padding: 4px 12px;
    border-radius: 12px;
    pointer-events: none;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.interactive-diagram:hover .diagram-hint {
    opacity: 0;
}

/* Threat card highlight animation */
.threat-card.highlight {
    box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
    border-color: var(--sidebar-active);
    animation: highlight-pulse 0.5s ease-in-out 3;
}

@keyframes highlight-pulse {
    0%, 100% { box-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
    50% { box-shadow: 0 0 25px rgba(52, 152, 219, 0.6); }
}

/* Print styles - static diagram */
@media print {
    .interactive-diagram .diagram-toolbar,
    .interactive-diagram .diagram-hint,
    .interactive-diagram .fullscreen-close {
        display: none !important;
    }
    .interactive-diagram .diagram-viewport {
        max-height: none !important;
        overflow: visible !important;
        cursor: default !important;
        min-height: auto !important;
    }
    .interactive-diagram .diagram-canvas {
        transform: none !important;
    }
    .interactive-diagram .plantuml-diagram {
        width: auto !important;
        max-width: 100% !important;
        max-height: 95vh !important;
        height: auto !important;
        display: block;
        margin: 0 auto;
        image-rendering: high-quality;
    }
    .diagram-tooltip {
        display: none !important;
    }
}

/* No-JS fallback */
.no-js .interactive-diagram .diagram-toolbar {
    display: none;
}

.no-js .interactive-diagram .diagram-viewport {
    overflow: auto;
    cursor: default;
}

    </style>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>
<body>

    <!-- Print Mode Indicator Banner -->
    <div class="print-mode-indicator" id="printModeIndicator">
        <span> Print/PDF Mode Active - All sections expanded, interactive features disabled</span>
        <span class="print-actions">
            <button onclick="window.print()" title="Print or Save as PDF"> Print / Save PDF</button>
            <button class="exit-btn" onclick="togglePrintMode()"> Exit Print Mode</button>
        </span>
    </div>

    <!-- Print Mode Toggle Button -->
    <button class="print-mode-toggle" id="printModeToggle" onclick="togglePrintMode()" title="Toggle Print/PDF Mode">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 6,2 18,2 18,9"></polyline>
            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
            <rect x="6" y="14" width="12" height="8"></rect>
        </svg>
        <span>Print Mode</span>
    </button>

    <!-- LEFT SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Threat Models</h2>
            <div class="subtitle">Security Analysis Platform</div>
        </div>
        
        <!-- Threat Model List -->
        <div class="model-list">
            
                
                
                <div class="model-item current">
                    <div class="model-icon">TM</div>
                    <div class="model-name">BYOD Access Architecture</div>
                </div>
                
                
                
                <a href="../../serverless-upload/reports/threat-model.html" class="model-item-link">
                    <div class="model-item">
                        <div class="model-icon">TM</div>
                        <div class="model-name">Serverless File Upload &amp; Processing Platform</div>
                    </div>
                </a>
                
                
            
        </div>
        
        <!-- Current Model Navigation -->
        <nav class="sidebar-nav">
            <!-- Summary Section -->
            <div class="nav-section expanded">
                <div class="nav-section-header" onclick="toggleSection(this)">
                    <span class="nav-toggle">
                        <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </span>
                    <span class="nav-section-title">Overview</span>
                </div>
                <div class="nav-section-content">
                    <a href="#summary" class="nav-item">Summary</a>
                    <a href="#threat-summary" class="nav-item">Threat Summary</a>
                </div>
            </div>
            
            <!-- Scope Section -->
            <div class="nav-section expanded">
                <div class="nav-section-header" onclick="toggleSection(this)">
                    <span class="nav-toggle">
                        <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </span>
                    <span class="nav-section-title">Scope & Analysis</span>
                </div>
                <div class="nav-section-content">
                    <a href="#scope" class="nav-item">Scope</a>
                    <a href="#analysis" class="nav-item">Analysis</a>
                    <a href="#attack-tree" class="nav-item">Attack Tree</a>
                    <a href="#dfd" class="nav-item">Data Flow Diagram</a>
                    <a href="#puml-dfd" class="nav-item">PlantUML Risk View</a>
                </div>
            </div>
            
            <!-- Assets Section -->
            <div class="nav-section expanded">
                <div class="nav-section-header" onclick="toggleSection(this)">
                    <span class="nav-toggle">
                        <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </span>
                    <span class="nav-section-title">Assets (7)</span>
                </div>
            </div>
            
            <!-- Threats Section -->
            <div class="nav-section expanded">
                <div class="nav-section-header" onclick="toggleSection(this)">
                    <span class="nav-toggle">
                        <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </span>
                    <span class="nav-section-title">Threats (9)</span>
                </div>
                <div class="nav-section-content">
                    
                    
                        
                            
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                        
                    
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                    
                    <div class="nav-threat-group" data-threat-group="Spoofing">
                        <div class="nav-threat-group-header" onclick="toggleThreatGroup(this)">
                            <span class="nav-threat-group-toggle">
                                <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                            </span>
                            <span class="nav-threat-group-title">Spoofing</span>
                            <span class="nav-threat-group-count">3</span>
                        </div>
                        <div class="nav-threat-group-items">
                            
                            <a href="#threat-T-01" class="nav-threat-item">
                                
                                <span class="cvss cvss-high" style="font-size: 0.65rem; margin-right: 5px;">8.1</span>
                                
                                Stolen Credentials...
                            </a>
                            
                            <a href="#threat-T-02" class="nav-threat-item">
                                
                                <span class="cvss cvss-medium" style="font-size: 0.65rem; margin-right: 5px;">6.8</span>
                                
                                Device ID Spoofing
                            </a>
                            
                            <a href="#threat-T-03" class="nav-threat-item">
                                
                                <span class="cvss cvss-high" style="font-size: 0.65rem; margin-right: 5px;">8.1</span>
                                
                                MFA Fatigue Attack
                            </a>
                            
                        </div>
                    </div>
                    
                    <div class="nav-threat-group" data-threat-group="Tampering">
                        <div class="nav-threat-group-header" onclick="toggleThreatGroup(this)">
                            <span class="nav-threat-group-toggle">
                                <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                            </span>
                            <span class="nav-threat-group-title">Tampering</span>
                            <span class="nav-threat-group-count">1</span>
                        </div>
                        <div class="nav-threat-group-items">
                            
                            <a href="#threat-T-04" class="nav-threat-item">
                                
                                <span class="cvss cvss-medium" style="font-size: 0.65rem; margin-right: 5px;">6.3</span>
                                
                                Manipulation of...
                            </a>
                            
                        </div>
                    </div>
                    
                    <div class="nav-threat-group" data-threat-group="Information Disclosure">
                        <div class="nav-threat-group-header" onclick="toggleThreatGroup(this)">
                            <span class="nav-threat-group-toggle">
                                <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                            </span>
                            <span class="nav-threat-group-title">Information Disclosure</span>
                            <span class="nav-threat-group-count">3</span>
                        </div>
                        <div class="nav-threat-group-items">
                            
                            <a href="#threat-T-05" class="nav-threat-item">
                                
                                <span class="cvss cvss-medium" style="font-size: 0.65rem; margin-right: 5px;">5.5</span>
                                
                                Data Leakage via...
                            </a>
                            
                            <a href="#threat-T-06" class="nav-threat-item">
                                
                                <span class="cvss cvss-high" style="font-size: 0.65rem; margin-right: 5px;">7.1</span>
                                
                                Token Theft via...
                            </a>
                            
                            <a href="#threat-T-07" class="nav-threat-item">
                                
                                <span class="cvss cvss-medium" style="font-size: 0.65rem; margin-right: 5px;">6.5</span>
                                
                                Insecure Backup to...
                            </a>
                            
                        </div>
                    </div>
                    
                    <div class="nav-threat-group" data-threat-group="Elevation of Privilege">
                        <div class="nav-threat-group-header" onclick="toggleThreatGroup(this)">
                            <span class="nav-threat-group-toggle">
                                <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                            </span>
                            <span class="nav-threat-group-title">Elevation of Privilege</span>
                            <span class="nav-threat-group-count">1</span>
                        </div>
                        <div class="nav-threat-group-items">
                            
                            <a href="#threat-T-08" class="nav-threat-item">
                                
                                <span class="cvss cvss-high" style="font-size: 0.65rem; margin-right: 5px;">8.1</span>
                                
                                Over-Permissive...
                            </a>
                            
                        </div>
                    </div>
                    
                    <div class="nav-threat-group" data-threat-group="Denial of Service">
                        <div class="nav-threat-group-header" onclick="toggleThreatGroup(this)">
                            <span class="nav-threat-group-toggle">
                                <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                            </span>
                            <span class="nav-threat-group-title">Denial of Service</span>
                            <span class="nav-threat-group-count">1</span>
                        </div>
                        <div class="nav-threat-group-items">
                            
                            <a href="#threat-T-09" class="nav-threat-item">
                                
                                <span class="cvss cvss-high" style="font-size: 0.65rem; margin-right: 5px;">7.5</span>
                                
                                Denial of Service via...
                            </a>
                            
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <!-- Security Testing Section -->
            <div class="nav-section">
                <div class="nav-section-header" onclick="toggleSection(this)">
                    <span class="nav-toggle">
                        <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </span>
                    <span class="nav-section-title" style="color: #9c27b0;"> Security Testing</span>
                </div>
                <div class="nav-section-content">
                    <a href="#security-testing" class="nav-item">Test Cases (9)</a>
                </div>
            </div>
        </nav>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <h1>BYOD Access Architecture</h1>
            <div class="meta">
                Model ID: TM-BYOD-ARCH | Version: 1.0 | Generated: 2026-01-24 21:13:21 UTC
            </div>
        </header>

    <!-- Summary Section -->
    <section id="summary">
        <h2>Summary</h2>
        <p style="margin-bottom: 15px;">
            <strong>9</strong> unmitigated threats requiring attention:
        </p>
        
        
        <table>
            <thead>
                <tr>
                    <th>Threat ID</th>
                    <th>Title</th>
                    <th>CVSS Score</th>
                    <th>Type</th>
                    <th style="width: 120px; text-align: center;">Always Present</th>
                </tr>
            </thead>
            <tbody>
                
                <tr>
                    <td><a href="#threat-T-01">T-01</a></td>
                    <td>Stolen Credentials Used from Unmanaged Device</td>
                    <td>
                        <span class="cvss cvss-high">
                            8.1
                        </span>
                    </td>
                    <td>Spoofing</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-03">T-03</a></td>
                    <td>MFA Fatigue Attack</td>
                    <td>
                        <span class="cvss cvss-high">
                            8.1
                        </span>
                    </td>
                    <td>Spoofing</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-08">T-08</a></td>
                    <td>Over-Permissive Access Policies</td>
                    <td>
                        <span class="cvss cvss-high">
                            8.1
                        </span>
                    </td>
                    <td>Elevation of Privilege</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-09">T-09</a></td>
                    <td>Denial of Service via Compliance Lockout</td>
                    <td>
                        <span class="cvss cvss-high">
                            7.5
                        </span>
                    </td>
                    <td>Denial of Service</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-06">T-06</a></td>
                    <td>Token Theft via Malware on BYOD</td>
                    <td>
                        <span class="cvss cvss-high">
                            7.1
                        </span>
                    </td>
                    <td>Information Disclosure</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-02">T-02</a></td>
                    <td>Device ID Spoofing</td>
                    <td>
                        <span class="cvss cvss-medium">
                            6.8
                        </span>
                    </td>
                    <td>Spoofing</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-07">T-07</a></td>
                    <td>Insecure Backup to Personal Cloud</td>
                    <td>
                        <span class="cvss cvss-medium">
                            6.5
                        </span>
                    </td>
                    <td>Information Disclosure</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-04">T-04</a></td>
                    <td>Manipulation of Device Compliance State</td>
                    <td>
                        <span class="cvss cvss-medium">
                            6.3
                        </span>
                    </td>
                    <td>Tampering</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-05">T-05</a></td>
                    <td>Data Leakage via Screenshots or Copy-Paste</td>
                    <td>
                        <span class="cvss cvss-medium">
                            5.5
                        </span>
                    </td>
                    <td>Information Disclosure</td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                </tr>
                
            </tbody>
        </table>
        
    </section>

    <!-- Threat Summary Section -->
    <section id="threat-summary">
        <h2>Threat Summary</h2>
        <table>
            <thead>
                <tr>
                    <th>Threat</th>
                    <th style="width: 100px; text-align: center;">Mitigated</th>
                    <th style="width: 120px; text-align: center;">Always Present</th>
                    <th style="width: 180px; text-align: center;">Countermeasures Operational</th>
                </tr>
            </thead>
            <tbody>
                
                <tr>
                    <td><a href="#threat-T-01">Stolen Credentials Used from Unmanaged Device</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--green); font-weight: 600;">TRUE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-02">Device ID Spoofing</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--red); font-weight: 600;">FALSE</span>
                        <span style="color: #666; font-size: 0.85rem;">(0/2)</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-03">MFA Fatigue Attack</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--red); font-weight: 600;">FALSE</span>
                        <span style="color: #666; font-size: 0.85rem;">(1/2)</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-04">Manipulation of Device Compliance State</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--red); font-weight: 600;">FALSE</span>
                        <span style="color: #666; font-size: 0.85rem;">(1/2)</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-05">Data Leakage via Screenshots or Copy-Paste</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--green); font-weight: 600;">TRUE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-06">Token Theft via Malware on BYOD</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--red); font-weight: 600;">FALSE</span>
                        <span style="color: #666; font-size: 0.85rem;">(1/2)</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-07">Insecure Backup to Personal Cloud</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--green); font-weight: 600;">TRUE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-08">Over-Permissive Access Policies</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--green); font-weight: 600;">TRUE</span>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><a href="#threat-T-09">Denial of Service via Compliance Lockout</a></td>
                    <td style="text-align: center;">
                        
                        <span class="status-icon status-unmitigated"></span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        <span style="color: var(--text-muted); font-weight: 500;">FALSE</span>
                        
                    </td>
                    <td style="text-align: center;">
                        
                        
                        
                        <span style="color: var(--green); font-weight: 600;">TRUE</span>
                        
                    </td>
                </tr>
                
            </tbody>
        </table>
    </section>

    <!-- Scope Section -->
    <section id="scope">
        <h2>Scope</h2>
        <div class="scope-text">
            Enterprise BYOD Security Architecture
        </div>

        <!-- Analysis -->
        <h3 id="analysis">Analysis</h3>
        <table>
            <tr>
                <th style="width: 200px;">Total Assets</th>
                <td>7</td>
            </tr>
            <tr>
                <th>Total Threats</th>
                <td>9</td>
            </tr>
            <tr>
                <th>Mitigated Threats</th>
                <td>0 / 9</td>
            </tr>
            <tr>
                <th>Total Countermeasures</th>
                <td>17</td>
            </tr>
            <tr>
                <th>Operational Countermeasures</th>
                <td>12 / 17</td>
            </tr>
            <tr>
                <th>Attackers Considered</th>
                <td>External Attacker, Malicious Insider, Negligent Device Owner</td>
            </tr>
        </table>

        
        <h4 style="margin: 20px 0 10px 0;">Assets Identified</h4>
        <table>
            <thead>
                <tr>
                    <th>Asset</th>
                    <th>Type</th>
                    <th>Trust Zone</th>
                </tr>
            </thead>
            <tbody>
                
                <tr>
                    <td>User Device (BYOD)</td>
                    <td>Client</td>
                    <td>Untrusted</td>
                </tr>
                
                <tr>
                    <td>Identity Provider</td>
                    <td>Serverless Service</td>
                    <td>Corporate Cloud</td>
                </tr>
                
                <tr>
                    <td>Device Management Platform</td>
                    <td>Serverless Service</td>
                    <td>Corporate Cloud</td>
                </tr>
                
                <tr>
                    <td>Conditional Access Engine</td>
                    <td>Compute</td>
                    <td>Corporate Cloud</td>
                </tr>
                
                <tr>
                    <td>Corporate Cloud Services</td>
                    <td>Data Store</td>
                    <td>Corporate Cloud</td>
                </tr>
                
                <tr>
                    <td>Endpoint Security Agent</td>
                    <td>Client Service</td>
                    <td>Managed Container</td>
                </tr>
                
                <tr>
                    <td>Logging &amp; Monitoring Platform</td>
                    <td>Database</td>
                    <td>Corporate Cloud</td>
                </tr>
                
            </tbody>
        </table>
        

        <!-- Attack Tree -->
        <h3 id="attack-tree">Attack Tree</h3>
        
        
        <!-- Attack Tree Legend -->
        <div class="attack-tree-legend">
            <div class="legend-title">Legend:</div>
            <div class="legend-items">
                <div class="legend-item">
                    <span class="legend-color" style="background: #2c3e50;"></span>
                    <span>Threat Model (Root)</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #3498db;"></span>
                    <span>Assets</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #e74c3c;"></span>
                    <span>Threats - Critical/High CVSS</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #f39c12;"></span>
                    <span>Threats - Medium CVSS</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #27ae60;"></span>
                    <span>Mitigations - In Place</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #bdc3c7;"></span>
                    <span>Mitigations - Planned</span>
                </div>
            </div>
            <div class="legend-edges">
                <span><strong>Flow:</strong> Threat Model  Assets  Threats  Mitigations</span>
                <span><strong> impacts</strong> = Asset has threat</span>
                <span><strong> mitigates</strong> = Control mitigates threat</span>
            </div>
        </div>
        
        <div class="diagram-container attack-tree-container"><div class="mermaid" data-diagram-id="attack-tree-mermaid">graph LR

    %% Threat Model Root
    ROOT(["BYOD Access Architecture"])

    %% Assets
    A_A_BYOD_DEVICE["User Device BYOD"]
    ROOT --> A_A_BYOD_DEVICE
    A_A_CORP_SERVICES["Corporate Cloud Services"]
    ROOT --> A_A_CORP_SERVICES

    %% Threats
    T_T_01["Stolen Credentials Used from Unmanaged Device | 8.1 High"]
    A_A_BYOD_DEVICE --> T_T_01
    T_T_02["Device ID Spoofing | 6.8 Medium"]
    A_A_BYOD_DEVICE --> T_T_02
    T_T_03["MFA Fatigue Attack | 8.1 High"]
    A_A_BYOD_DEVICE --> T_T_03
    T_T_04["Manipulation of Device Compliance State | 6.3 Medium"]
    A_A_BYOD_DEVICE --> T_T_04
    T_T_05["Data Leakage via Screenshots or Copy-Paste | 5.5 Medium"]
    A_A_BYOD_DEVICE --> T_T_05
    T_T_06["Token Theft via Malware on BYOD | 7.1 High"]
    A_A_BYOD_DEVICE --> T_T_06
    T_T_07["Insecure Backup to Personal Cloud | 6.5 Medium"]
    A_A_BYOD_DEVICE --> T_T_07
    T_T_08["Over-Permissive Access Policies | 8.1 High"]
    A_A_BYOD_DEVICE --> T_T_08
    T_T_09["Denial of Service via Compliance Lockout | 7.5 High"]
    A_A_CORP_SERVICES --> T_T_09

    %% Mitigations
    M_T_01_CM_01(["DONE: Device Compliance Enforcement"])
    T_T_01 -.-> M_T_01_CM_01
    M_T_01_CM_02(["DONE: MFA Enforcement"])
    T_T_01 -.-> M_T_01_CM_02
    M_T_02_CM_03(["TODO: Hardware-Bound Device Certificates"])
    T_T_02 -.-> M_T_02_CM_03
    M_T_02_CM_04(["TODO: Device Attestation"])
    T_T_02 -.-> M_T_02_CM_04
    M_T_03_CM_05(["DONE: MFA Rate Limiting"])
    T_T_03 -.-> M_T_03_CM_05
    M_T_03_CM_06(["TODO: Number Matching MFA"])
    T_T_03 -.-> M_T_03_CM_06
    M_T_04_CM_07(["DONE: Jailbreak/Root Detection"])
    T_T_04 -.-> M_T_04_CM_07
    M_T_04_CM_08(["TODO: Endpoint Agent Integrity Checks"])
    T_T_04 -.-> M_T_04_CM_08
    M_T_05_CM_09(["DONE: DLP in Managed Apps"])
    T_T_05 -.-> M_T_05_CM_09
    M_T_05_CM_10(["DONE: Screen Capture Blocking"])
    T_T_05 -.-> M_T_05_CM_10
    M_T_06_CM_11(["TODO: Token Binding"])
    T_T_06 -.-> M_T_06_CM_11
    M_T_06_CM_12(["DONE: Short Token Lifetimes"])
    T_T_06 -.-> M_T_06_CM_12
    M_T_07_CM_13(["DONE: Managed App Backup Exclusion"])
    T_T_07 -.-> M_T_07_CM_13
    M_T_08_CM_14(["DONE: Policy Review and Testing"])
    T_T_08 -.-> M_T_08_CM_14
    M_T_08_CM_15(["DONE: Least Privilege by Default"])
    T_T_08 -.-> M_T_08_CM_15
    M_T_09_CM_16(["DONE: Compliance Grace Period"])
    T_T_09 -.-> M_T_09_CM_16
    M_T_09_CM_17(["DONE: Self-Service Remediation"])
    T_T_09 -.-> M_T_09_CM_17

    %% Styles
    style ROOT fill:#2c3e50,stroke:#1a252f,color:#fff,stroke-width:3px
    style A_A_BYOD_DEVICE fill:#3498db,stroke:#2980b9,color:#fff
    style A_A_CORP_SERVICES fill:#3498db,stroke:#2980b9,color:#fff
    style T_T_01 fill:#e74c3c,stroke:#c0392b,color:#fff,stroke-width:2px
    style T_T_02 fill:#f39c12,stroke:#d68910,color:#fff,stroke-width:2px
    style T_T_03 fill:#e74c3c,stroke:#c0392b,color:#fff,stroke-width:2px
    style T_T_04 fill:#f39c12,stroke:#d68910,color:#fff,stroke-width:2px
    style T_T_05 fill:#f39c12,stroke:#d68910,color:#fff,stroke-width:2px
    style T_T_06 fill:#e74c3c,stroke:#c0392b,color:#fff,stroke-width:2px
    style T_T_07 fill:#f39c12,stroke:#d68910,color:#fff,stroke-width:2px
    style T_T_08 fill:#e74c3c,stroke:#c0392b,color:#fff,stroke-width:2px
    style T_T_09 fill:#e74c3c,stroke:#c0392b,color:#fff,stroke-width:2px
    style M_T_01_CM_01 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_01_CM_02 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_02_CM_03 fill:#f8f9fa,stroke:#7f8c8d,color:#2c3e50
    style M_T_02_CM_04 fill:#f8f9fa,stroke:#7f8c8d,color:#2c3e50
    style M_T_03_CM_05 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_03_CM_06 fill:#f8f9fa,stroke:#7f8c8d,color:#2c3e50
    style M_T_04_CM_07 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_04_CM_08 fill:#f8f9fa,stroke:#7f8c8d,color:#2c3e50
    style M_T_05_CM_09 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_05_CM_10 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_06_CM_11 fill:#f8f9fa,stroke:#7f8c8d,color:#2c3e50
    style M_T_06_CM_12 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_07_CM_13 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_08_CM_14 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_08_CM_15 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_09_CM_16 fill:#27ae60,stroke:#1e8449,color:#fff
    style M_T_09_CM_17 fill:#27ae60,stroke:#1e8449,color:#fff</div></div>
        

        <!-- Data Flow Diagram -->
        
        <h3 id="dfd">Data Flow Diagrams</h3>
        <p class="diagram-description">This section includes PlantUML component view, sequence view, and UML source.</p>
        
        <div class="diagram-tabs">
            <button class="tab-btn active" data-tab="puml-component">Component View</button>
            <button class="tab-btn" data-tab="puml-sequence">Sequence View</button>
            <button class="tab-btn" data-tab="puml-source">UML Source</button>
        </div>
        
        <div class="tab-content active" id="puml-component" data-tab-name="Component View (PlantUML)">
            
<div class="interactive-diagram" 
     data-diagram-type="plantuml-component" 
     data-diagram-title="PlantUML Component Diagram"
     data-content-type="plantuml-img">
    
    
    <div class="diagram-toolbar">
        <div class="diagram-toolbar-left">
            <span class="diagram-title-label">PlantUML Component Diagram</span>
        </div>
        <div class="diagram-toolbar-center">
            <button class="toolbar-btn" data-action="zoom-out" title="Zoom Out (-)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/><line x1="7" y1="11" x2="15" y2="11"/>
                </svg>
            </button>
            <span class="zoom-level">100%</span>
            <button class="toolbar-btn" data-action="zoom-in" title="Zoom In (+)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/><line x1="11" y1="7" x2="11" y2="15"/><line x1="7" y1="11" x2="15" y2="11"/>
                </svg>
            </button>
        </div>
        <div class="diagram-toolbar-right">
            <button class="toolbar-btn" data-action="reset" title="Reset View (0)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                    <path d="M3 3v5h5"/>
                </svg>
            </button>
            <button class="toolbar-btn" data-action="fit" title="Fit to View">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
                </svg>
            </button>
            <button class="toolbar-btn" data-action="fullscreen" title="Fullscreen (F)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m0 8v3a2 2 0 0 0 2 2h3m8-18h3a2 2 0 0 1 2 2v3m0 8v3a2 2 0 0 1-2 2h-3"/>
                </svg>
            </button>
        </div>
    </div>
    
    
    <div class="diagram-viewport">
        <div class="diagram-canvas">
            
            <img class="plantuml-diagram" 
                 id="puml-component-img"
                 alt="PlantUML Component Diagram Loading..."
                 data-loading="true">
            
        </div>
    </div>
    
    
    <button class="fullscreen-close" data-action="exit-fullscreen" title="Exit Fullscreen (Esc)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
    </button>
    
    
    <div class="diagram-hint">
        <span>Scroll to zoom  Drag to pan  Click nodes for details</span>
    </div>
</div>

        </div>
        
        <div class="tab-content" id="puml-sequence" data-tab-name="Sequence View (PlantUML)">
            
<div class="interactive-diagram" 
     data-diagram-type="plantuml-sequence" 
     data-diagram-title="PlantUML Sequence Diagram"
     data-content-type="plantuml-img">
    
    
    <div class="diagram-toolbar">
        <div class="diagram-toolbar-left">
            <span class="diagram-title-label">PlantUML Sequence Diagram</span>
        </div>
        <div class="diagram-toolbar-center">
            <button class="toolbar-btn" data-action="zoom-out" title="Zoom Out (-)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/><line x1="7" y1="11" x2="15" y2="11"/>
                </svg>
            </button>
            <span class="zoom-level">100%</span>
            <button class="toolbar-btn" data-action="zoom-in" title="Zoom In (+)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/><line x1="11" y1="7" x2="11" y2="15"/><line x1="7" y1="11" x2="15" y2="11"/>
                </svg>
            </button>
        </div>
        <div class="diagram-toolbar-right">
            <button class="toolbar-btn" data-action="reset" title="Reset View (0)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                    <path d="M3 3v5h5"/>
                </svg>
            </button>
            <button class="toolbar-btn" data-action="fit" title="Fit to View">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
                </svg>
            </button>
            <button class="toolbar-btn" data-action="fullscreen" title="Fullscreen (F)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m0 8v3a2 2 0 0 0 2 2h3m8-18h3a2 2 0 0 1 2 2v3m0 8v3a2 2 0 0 1-2 2h-3"/>
                </svg>
            </button>
        </div>
    </div>
    
    
    <div class="diagram-viewport">
        <div class="diagram-canvas">
            
            <img class="plantuml-diagram" 
                 id="puml-sequence-img"
                 alt="PlantUML Sequence Diagram Loading..."
                 data-loading="true">
            
        </div>
    </div>
    
    
    <button class="fullscreen-close" data-action="exit-fullscreen" title="Exit Fullscreen (Esc)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
    </button>
    
    
    <div class="diagram-hint">
        <span>Scroll to zoom  Drag to pan  Click nodes for details</span>
    </div>
</div>

        </div>
        
        <div class="tab-content" id="puml-source" data-tab-name="UML Source Code">
            <div class="puml-source-tabs">
                <button class="source-tab-btn active" data-source="component">Component PUML</button>
                <button class="source-tab-btn" data-source="sequence">Sequence PUML</button>
            </div>
            <div class="source-content active" id="source-component">
                <pre class="puml-source"><code>@startuml

title BYOD Access Architecture - Data Flow Diagram

!define CRITICAL_COLOR #FF6B6B
!define HIGH_COLOR #FFA500
!define MEDIUM_COLOR #FFD93D
!define LOW_COLOR #6BCB77
!define TRUST_BOUNDARY_COLOR #E8E8E8

skinparam {
    BackgroundColor white
    ArrowColor #333333
    ArrowFontSize 10
    ParticipantBorderColor #2c3e50
    ParticipantBackgroundColor #ecf0f1
    ParticipantFontColor #2c3e50
    NoteBackgroundColor #fffde7
    NoteBorderColor #ffc107
    RectangleBorderColor #2c3e50
    RectangleBorderStyle dashed
}

&#39; === TRUST ZONES AND PARTICIPANTS ===
rectangle &#34;Untrusted&#34; as zone_Untrusted &lt;&lt;trust_zone&gt;&gt; {
    component &#34;User Device (BYOD)&#34; as A_BYOD_DEVICE #f5c6cb
}

rectangle &#34;Corporate Cloud&#34; as zone_Corporate_Cloud &lt;&lt;trust_zone&gt;&gt; {
    component &#34;Identity Provider&#34; as A_IDP
    component &#34;Device Management Platform&#34; as A_MDM
    component &#34;Conditional Access Engine&#34; as A_COND_ACCESS
    component &#34;Corporate Cloud Services&#34; as A_CORP_SERVICES
    component &#34;Logging &amp; Monitoring Platform&#34; as A_LOGGING
}

rectangle &#34;Managed Container&#34; as zone_Managed_Container &lt;&lt;trust_zone&gt;&gt; {
    component &#34;Endpoint Security Agent&#34; as A_ENDPOINT_SEC
}

&#39; === DATA FLOWS ===
A_IDP --&gt; A_COND_ACCESS : Identity Verification (Internal API)
A_MDM --&gt; A_COND_ACCESS : Device Compliance Report (Internal API)
A_COND_ACCESS --&gt; A_IDP : Access Decision (Internal API)
A_CORP_SERVICES --&gt; A_LOGGING : Audit Logs (Syslog/API)
A_BYOD_DEVICE -[#FF0000,bold]-&gt; A_IDP : &lt;color:red&gt;&lt;b&gt;Authentication Request&lt;/b&gt;&lt;/color&gt; (HTTPS)\n!! CROSSES BOUNDARY
A_BYOD_DEVICE -[#FF0000,bold]-&gt; A_MDM : &lt;color:red&gt;&lt;b&gt;Device Registration&lt;/b&gt;&lt;/color&gt; (HTTPS)\n!! CROSSES BOUNDARY
A_BYOD_DEVICE -[#FF0000,bold]-&gt; A_CORP_SERVICES : &lt;color:red&gt;&lt;b&gt;Access Corporate Services&lt;/b&gt;&lt;/color&gt; (HTTPS)\n!! CROSSES BOUNDARY
A_IDP -[#FF0000,bold]-&gt; A_BYOD_DEVICE : &lt;color:red&gt;&lt;b&gt;Issue Access Token&lt;/b&gt;&lt;/color&gt; (HTTPS)\n!! CROSSES BOUNDARY
A_ENDPOINT_SEC -[#FF0000,bold]-&gt; A_MDM : &lt;color:red&gt;&lt;b&gt;Compliance Telemetry&lt;/b&gt;&lt;/color&gt; (HTTPS)\n!! CROSSES BOUNDARY

&#39; === LEGEND ===
legend right
    |= Color |= Meaning |
    | &lt;back:CRITICAL_COLOR&gt;    &lt;/back&gt; | Critical Risk (CVSS 9.0+) |
    | &lt;back:HIGH_COLOR&gt;    &lt;/back&gt; | High Risk (CVSS 7.0-8.9) |
    | &lt;back:MEDIUM_COLOR&gt;    &lt;/back&gt; | Medium Risk (CVSS 4.0-6.9) |
    | &lt;back:LOW_COLOR&gt;    &lt;/back&gt; | Low Risk (CVSS &lt; 4.0) |
    | &lt;color:red&gt;&gt;&lt;/color&gt; | Crosses Trust Boundary |
    | &lt;color:orange&gt;&gt;&lt;/color&gt; | Sensitive Data Flow |
endlegend

footer Generated from TM-BYOD-ARCH v1.0

@enduml</code></pre>
                <button class="copy-btn" onclick="copyPumlSource('component')">Copy PlantUML</button>
            </div>
            <div class="source-content" id="source-sequence">
                <pre class="puml-source"><code>@startuml

title BYOD Access Architecture - Dataflow Sequence

skinparam {
    ParticipantBorderColor #2c3e50
    ParticipantBackgroundColor #ecf0f1
    SequenceArrowColor #333333
    SequenceLifeLineBorderColor #bdc3c7
    NoteBackgroundColor #fff3cd
    NoteBorderColor #ffc107
}

box &#34;Untrusted&#34; #f8d7da
    participant &#34;User Device (BYOD)&#34; as A_BYOD_DEVICE
end box

box &#34;Corporate Cloud&#34; #d4edda
    participant &#34;Identity Provider&#34; as A_IDP
    participant &#34;Device Management Platform&#34; as A_MDM
    participant &#34;Conditional Access Engine&#34; as A_COND_ACCESS
    participant &#34;Corporate Cloud Services&#34; as A_CORP_SERVICES
    database &#34;Logging &amp; Monitoring Platform&#34; as A_LOGGING
end box

box &#34;Managed Container&#34; #d4edda
    participant &#34;Endpoint Security Agent&#34; as A_ENDPOINT_SEC
end box

== Data Flow Interactions ==

A_BYOD_DEVICE -[#FF0000]&gt; A_CORP_SERVICES: &lt;color:red&gt;&lt;b&gt;Access Corporate Services&lt;/b&gt;&lt;/color&gt;\n(HTTPS)
note right #FFCCCC
    ** CROSSES TRUST BOUNDARY**
    Classification: Confidential
end note
A_BYOD_DEVICE -[#FF0000]&gt; A_IDP: &lt;color:red&gt;&lt;b&gt;Authentication Request&lt;/b&gt;&lt;/color&gt;\n(HTTPS)
note right #FFCCCC
    ** CROSSES TRUST BOUNDARY**
    Classification: Restricted
end note
A_BYOD_DEVICE -[#FF0000]&gt; A_MDM: &lt;color:red&gt;&lt;b&gt;Device Registration&lt;/b&gt;&lt;/color&gt;\n(HTTPS)
note right #FFCCCC
    ** CROSSES TRUST BOUNDARY**
    Classification: Internal
end note
A_IDP -[#FF0000]&gt; A_BYOD_DEVICE: &lt;color:red&gt;&lt;b&gt;Issue Access Token&lt;/b&gt;&lt;/color&gt;\n(HTTPS)
note right #FFCCCC
    ** CROSSES TRUST BOUNDARY**
    Classification: Restricted
end note
A_ENDPOINT_SEC -[#FF0000]&gt; A_MDM: &lt;color:red&gt;&lt;b&gt;Compliance Telemetry&lt;/b&gt;&lt;/color&gt;\n(HTTPS)
note right #FFCCCC
    ** CROSSES TRUST BOUNDARY**
    Classification: Internal
end note
A_IDP -&gt; A_COND_ACCESS: Identity Verification\n(Internal API)
A_MDM -&gt; A_COND_ACCESS: Device Compliance Report\n(Internal API)
A_COND_ACCESS -&gt; A_IDP: Access Decision\n(Internal API)
A_CORP_SERVICES -&gt; A_LOGGING: Audit Logs\n(Syslog/API)

footer Model: TM-BYOD-ARCH | Version: 1.0

@enduml</code></pre>
                <button class="copy-btn" onclick="copyPumlSource('sequence')">Copy PlantUML</button>
            </div>
        </div>
        
        <div class="puml-legend">
            <h4>Risk Color Legend</h4>
            <div class="legend-items">
                <div class="legend-item"><span class="legend-color critical"></span> Critical Risk (CVSS 9.0+)</div>
                <div class="legend-item"><span class="legend-color high"></span> High Risk (CVSS 7.0-8.9)</div>
                <div class="legend-item"><span class="legend-color medium"></span> Medium Risk (CVSS 4.0-6.9)</div>
                <div class="legend-item"><span class="legend-color low"></span> Low Risk (CVSS &lt; 4.0)</div>
            </div>
            <div class="legend-items">
                <div class="legend-item"><span class="legend-arrow red"></span> Crosses Trust Boundary</div>
                <div class="legend-item"><span class="legend-arrow orange"></span> Sensitive Data Flow</div>
            </div>
        </div>
        
    </section>

    <!-- Threats Section -->
    <section id="threats">
        <h2>Threats</h2>
        
        
        <div id="threat-T-01" class="threat-card">
            <div class="threat-card-header">
                <h4>Stolen Credentials Used from Unmanaged Device <span class="threat-id">( T-01 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Attacker steals user credentials via phishing and authenticates from a non-compliant device.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Unauthorized access to corporate data from an untrusted device.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                            <span class="sec-obj-tag">SO-ACCOUNT</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>8.1</strong>
                            <span class="cvss cvss-high" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                High
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Stolen Credentials Used from Unmanaged Device</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-ACCOUNT</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Attacker steals user credentials via phishing and authenticates from a non-compliant device.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Device Compliance Enforcement</div>
                            </div>
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">MFA Enforcement</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-01</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-01</span>
                            <span class="cm-title">Device Compliance Enforcement</span>
                        </div>
                    </div>
                    <div class="cm-desc">Require device enrollment and compliance before granting access.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-02</span>
                            <span class="cm-title">MFA Enforcement</span>
                        </div>
                    </div>
                    <div class="cm-desc">Require phishing-resistant MFA for all authentications.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-02" class="threat-card">
            <div class="threat-card-header">
                <h4>Device ID Spoofing <span class="threat-id">( T-02 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Attacker clones a compliant device ID to bypass device-based access controls.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Unauthorized device gains access by impersonating a registered device.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                            <span class="sec-obj-tag">SO-INT</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>6.8</strong>
                            <span class="cvss cvss-medium" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                Medium
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Device ID Spoofing</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-INT</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Attacker clones a compliant device ID to bypass device-based access controls.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm not-impl">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Hardware-Bound Device Certificates</div>
                            </div>
                            
                            <div class="vt-cm not-impl">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Device Attestation</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-02</h5>
                
                
                <div class="cm-item not-implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-03</span>
                            <span class="cm-title">Hardware-Bound Device Certificates</span>
                        </div>
                    </div>
                    <div class="cm-desc">Use TPM or Secure Enclave to bind device identity to hardware.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value no">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item not-implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-04</span>
                            <span class="cm-title">Device Attestation</span>
                        </div>
                    </div>
                    <div class="cm-desc">Verify device integrity signals during authentication.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value no">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-03" class="threat-card">
            <div class="threat-card-header">
                <h4>MFA Fatigue Attack <span class="threat-id">( T-03 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Attacker bombards user with repeated MFA push notifications until user approves out of frustration.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Attacker gains access using stolen primary credentials and user&#39;s fatigued approval.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>8.1</strong>
                            <span class="cvss cvss-high" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                High
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">MFA Fatigue Attack</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Attacker bombards user with repeated MFA push notifications until user approves out of frustration.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">MFA Rate Limiting</div>
                            </div>
                            
                            <div class="vt-cm not-impl">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Number Matching MFA</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-03</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-05</span>
                            <span class="cm-title">MFA Rate Limiting</span>
                        </div>
                    </div>
                    <div class="cm-desc">Limit number of MFA prompts within a time window.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item not-implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-06</span>
                            <span class="cm-title">Number Matching MFA</span>
                        </div>
                    </div>
                    <div class="cm-desc">Use number-matching or FIDO2 instead of push-only MFA.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value no">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-04" class="threat-card">
            <div class="threat-card-header">
                <h4>Manipulation of Device Compliance State <span class="threat-id">( T-04 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Attacker or user manipulates endpoint agent or MDM signals to report false compliance.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Non-compliant device appears compliant and gains unauthorized access.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                            <span class="sec-obj-tag">SO-INT</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>6.3</strong>
                            <span class="cvss cvss-medium" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                Medium
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Manipulation of Device Compliance State</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-INT</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Attacker or user manipulates endpoint agent or MDM signals to report false compliance.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Jailbreak/Root Detection</div>
                            </div>
                            
                            <div class="vt-cm not-impl">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Endpoint Agent Integrity Checks</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-04</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-07</span>
                            <span class="cm-title">Jailbreak/Root Detection</span>
                        </div>
                    </div>
                    <div class="cm-desc">Detect and block rooted or jailbroken devices.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item not-implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-08</span>
                            <span class="cm-title">Endpoint Agent Integrity Checks</span>
                        </div>
                    </div>
                    <div class="cm-desc">Use attestation to verify agent has not been tampered with.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value no">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-05" class="threat-card">
            <div class="threat-card-header">
                <h4>Data Leakage via Screenshots or Copy-Paste <span class="threat-id">( T-05 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">User or malware captures corporate data via screenshots, copy-paste, or screen recording.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Confidential corporate data is exfiltrated to personal apps or cloud storage.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>5.5</strong>
                            <span class="cvss cvss-medium" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                Medium
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Data Leakage via Screenshots or Copy-Paste</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>User or malware captures corporate data via screenshots, copy-paste, or screen recording.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">DLP in Managed Apps</div>
                            </div>
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Screen Capture Blocking</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-05</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-09</span>
                            <span class="cm-title">DLP in Managed Apps</span>
                        </div>
                    </div>
                    <div class="cm-desc">Enforce data loss prevention policies within managed application containers.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-10</span>
                            <span class="cm-title">Screen Capture Blocking</span>
                        </div>
                    </div>
                    <div class="cm-desc">Prevent screenshots and screen recordings in managed apps.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-06" class="threat-card">
            <div class="threat-card-header">
                <h4>Token Theft via Malware on BYOD <span class="threat-id">( T-06 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Malware on personal device steals OAuth access or refresh tokens.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Attacker uses stolen tokens to access corporate resources without re-authentication.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>7.1</strong>
                            <span class="cvss cvss-high" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                High
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Token Theft via Malware on BYOD</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Malware on personal device steals OAuth access or refresh tokens.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm not-impl">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Token Binding</div>
                            </div>
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Short Token Lifetimes</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-06</h5>
                
                
                <div class="cm-item not-implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-11</span>
                            <span class="cm-title">Token Binding</span>
                        </div>
                    </div>
                    <div class="cm-desc">Bind access tokens to device hardware or certificate.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value no">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-12</span>
                            <span class="cm-title">Short Token Lifetimes</span>
                        </div>
                    </div>
                    <div class="cm-desc">Use short-lived access tokens and require frequent re-authentication.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-07" class="threat-card">
            <div class="threat-card-header">
                <h4>Insecure Backup to Personal Cloud <span class="threat-id">( T-07 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Corporate data cached on device is backed up to user&#39;s personal iCloud or Google Drive.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Corporate data is stored in unmanaged personal cloud storage.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>6.5</strong>
                            <span class="cvss cvss-medium" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                Medium
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Insecure Backup to Personal Cloud</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Corporate data cached on device is backed up to user&#39;s personal iCloud or Google Drive.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Managed App Backup Exclusion</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-07</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-13</span>
                            <span class="cm-title">Managed App Backup Exclusion</span>
                        </div>
                    </div>
                    <div class="cm-desc">Configure managed apps to exclude data from device backups.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-08" class="threat-card">
            <div class="threat-card-header">
                <h4>Over-Permissive Access Policies <span class="threat-id">( T-08 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Conditional access policy grants excessive access due to misconfiguration.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Users gain access to resources they should not have based on their role or device state.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-CONF</span>
                            
                            <span class="sec-obj-tag">SO-INT</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">User Device (BYOD)</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>8.1</strong>
                            <span class="cvss cvss-high" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                High
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Over-Permissive Access Policies</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-CONF</span>
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-INT</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Conditional access policy grants excessive access due to misconfiguration.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Policy Review and Testing</div>
                            </div>
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Least Privilege by Default</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-08</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-14</span>
                            <span class="cm-title">Policy Review and Testing</span>
                        </div>
                    </div>
                    <div class="cm-desc">Regularly review and test conditional access policies.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-15</span>
                            <span class="cm-title">Least Privilege by Default</span>
                        </div>
                    </div>
                    <div class="cm-desc">Configure policies to deny by default, allow only necessary access.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div id="threat-T-09" class="threat-card">
            <div class="threat-card-header">
                <h4>Denial of Service via Compliance Lockout <span class="threat-id">( T-09 )</span></h4>
            </div>
            <div class="threat-card-body">
                
                <!-- Left side: Details -->
                <div class="threat-details">
                    <div class="detail-row">
                        <div class="detail-label">Threat Status:</div>
                        <div class="detail-value unmitigated">
                            Unmitigated
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Threat Description</div>
                        <div class="detail-value">Legitimate user&#39;s device becomes non-compliant and they are locked out of all corporate resources.</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Impact</div>
                        <div class="detail-value">
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                
                                <li>Productivity loss</li>
                                
                                <li>user frustration</li>
                                
                                <li>potential business disruption.</li>
                                
                            </ul>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Security Objectives</div>
                        <div class="sec-obj-tags">
                            
                            <span class="sec-obj-tag">SO-AVAIL</span>
                            
                        </div>
                    </div>
                    
                    
                    <div class="detail-row">
                        <div class="detail-label">Affected Assets</div>
                        <div class="affected-assets">
                            
                            <span class="affected-asset-badge">Corporate Cloud Services</span>
                            
                        </div>
                    </div>
                    
                    
                    
                    <div class="cvss-section">
                        <div class="detail-label">CVSS</div>
                        <div class="cvss-score">
                            Base Score: <strong>7.5</strong>
                            <span class="cvss cvss-high" style="margin-left: 8px; padding: 2px 8px; border-radius: 4px;">
                                High
                            </span>
                        </div>
                        <div class="cvss-vector">Vector: <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</code></div>
                    </div>
                    
                </div>
                
                <!-- Right side: Visual diagram -->
                <div class="threat-diagram">
                    <div class="visual-tree">
                        <!-- Threat Node -->
                        <div class="vt-node vt-threat">
                            <div style="font-size: 0.75rem; color: #666; margin-bottom: 5px;">Threat</div>
                            <div class="vt-threat-title">Denial of Service via Compliance Lockout</div>
                            <div class="sec-obj-tags">
                                
                                <span class="sec-obj-tag" style="color: var(--red); border-color: var(--red);">SO-AVAIL</span>
                                
                            </div>
                        </div>
                        
                        <!-- Connector: exploits -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">exploits</div>
                            <div class="vt-line"></div>
                        </div>
                        
                        <!-- Attack Node -->
                        <div class="vt-node vt-attack">
                            <div class="vt-attack-label">Attack</div>
                            <div>Legitimate user&#39;s device becomes non-compliant and they are locked out of all corporate resources.</div>
                        </div>
                        
                        <!-- Connector: mitigates -->
                        <div class="vt-connector">
                            <div class="vt-line"></div>
                            <div class="vt-label">mitigates</div>
                        </div>
                        
                        <!-- Countermeasures row -->
                        <div class="vt-cm-row">
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Compliance Grace Period</div>
                            </div>
                            
                            <div class="vt-cm ">
                                <div class="vt-cm-label">Countermeasure</div>
                                <div class="vt-cm-title">Self-Service Remediation</div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Countermeasures detailed section -->
            <div class="cm-section" style="margin: 0 20px 20px 20px;">
                <h5>Counter-measures for T-09</h5>
                
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-16</span>
                            <span class="cm-title">Compliance Grace Period</span>
                        </div>
                    </div>
                    <div class="cm-desc">Allow short grace period for users to remediate non-compliance.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
                <div class="cm-item implemented">
                    <div class="cm-header">
                        <div>
                            <span class="cm-id">CM-17</span>
                            <span class="cm-title">Self-Service Remediation</span>
                        </div>
                    </div>
                    <div class="cm-desc">Provide clear guidance and tools for users to fix compliance issues.</div>
                    <div class="cm-status">
                        <span class="cm-status-label">Countermeasure in place?</span>
                        <span class="cm-status-value yes">
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </section>

    <!-- Security Testing Section -->
    <section id="security-testing" class="testing-section">
        <h2>
            <span class="asset-icon"></span>
            Security Testing
        </h2>
        
        <div class="testing-intro">
            <p><strong>Purpose:</strong> This section provides security test cases derived from the identified threats. 
            Use these test cases during penetration testing and security assessments to validate that threats have been 
            properly mitigated and security controls are effective.</p>
        </div>
        
        <!-- Testing Progress Summary -->
        <div class="testing-summary no-print">
            <div class="testing-stat total">
                <div class="testing-stat-value" id="test-total">9</div>
                <div class="testing-stat-label">Total Tests</div>
            </div>
            <div class="testing-stat passed">
                <div class="testing-stat-value" id="test-passed">0</div>
                <div class="testing-stat-label">Passed</div>
            </div>
            <div class="testing-stat failed">
                <div class="testing-stat-value" id="test-failed">0</div>
                <div class="testing-stat-label">Failed</div>
            </div>
            <div class="testing-stat pending">
                <div class="testing-stat-value" id="test-pending">9</div>
                <div class="testing-stat-label">Not Tested</div>
            </div>
        </div>
        
        <!-- Test Cases Generated from Threats -->
        
        <div class="test-case-card" id="test-T-01" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-01</span>
                    <h4>Stolen Credentials Used from Unmanaged Device</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-01')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Attacker steals user credentials via phishing and authenticates from a non-compliant device.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">Conditional access should deny login from unregistered device.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Obtain valid user credentials via phishing simulation.</li>
                        
                        <li>Attempt to authenticate from a device not enrolled in MDM.</li>
                        
                        <li>Observe if conditional access blocks the attempt.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-02" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-02</span>
                    <h4>Device ID Spoofing</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-02')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Attacker clones a compliant device ID to bypass device-based access controls.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">Access should be denied unless device presents valid certificate tied to hardware.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Extract device ID from a compliant enrolled device.</li>
                        
                        <li>Attempt to replay or spoof the device ID from another device.</li>
                        
                        <li>Test if conditional access validates device certificate or hardware binding.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-03" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-03</span>
                    <h4>MFA Fatigue Attack</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-03')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Attacker bombards user with repeated MFA push notifications until user approves out of frustration.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">System should throttle MFA requests and alert on suspicious patterns.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Initiate multiple rapid authentication attempts with valid credentials.</li>
                        
                        <li>Observe if rate limiting or anomaly detection blocks the attack.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-04" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-04</span>
                    <h4>Manipulation of Device Compliance State</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-04')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Attacker or user manipulates endpoint agent or MDM signals to report false compliance.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">MDM should detect device tampering and mark device non-compliant.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Root or jailbreak a test device.</li>
                        
                        <li>Attempt to bypass endpoint security agent or spoof compliance signals.</li>
                        
                        <li>Check if MDM detects jailbreak/root or tampered agent.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-05" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-05</span>
                    <h4>Data Leakage via Screenshots or Copy-Paste</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-05')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>User or malware captures corporate data via screenshots, copy-paste, or screen recording.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">Managed app should block screenshots and restrict copy-paste to managed apps only.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Access corporate document in managed app.</li>
                        
                        <li>Attempt to take screenshot or copy text.</li>
                        
                        <li>Try to paste into personal messaging app.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-06" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-06</span>
                    <h4>Token Theft via Malware on BYOD</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-06')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Malware on personal device steals OAuth access or refresh tokens.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">Tokens should be short-lived, bound to device, and require re-authentication on anomalies.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Extract OAuth tokens from device storage or memory.</li>
                        
                        <li>Replay tokens from different device or IP.</li>
                        
                        <li>Test if token is bound to device or can be used elsewhere.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-07" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-07</span>
                    <h4>Insecure Backup to Personal Cloud</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-07')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Corporate data cached on device is backed up to user&#39;s personal iCloud or Google Drive.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">Managed app data should be excluded from device backups or encrypted separately.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Enable device backup to personal cloud account.</li>
                        
                        <li>Access corporate data in managed app.</li>
                        
                        <li>Check if corporate data is included in device backup.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-08" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-08</span>
                    <h4>Over-Permissive Access Policies</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-08')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Conditional access policy grants excessive access due to misconfiguration.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">Access should be denied based on role, device compliance, and data sensitivity.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Authenticate with low-privilege user account.</li>
                        
                        <li>Attempt to access high-sensitivity resources.</li>
                        
                        <li>Test if conditional access correctly enforces least privilege.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-case-card" id="test-T-09" data-test-status="not-tested">
            <div class="test-case-header" onclick="toggleTestCase(this)">
                <div class="test-case-title">
                    <span class="test-case-id">TC-T-09</span>
                    <h4>Denial of Service via Compliance Lockout</h4>
                </div>
                <select class="test-status-select not-tested no-print" onchange="updateTestStatus(this, 'T-09')" onclick="event.stopPropagation()">
                    <option value="not-tested"> Not Tested</option>
                    <option value="in-progress"> In Progress</option>
                    <option value="passed"> Passed</option>
                    <option value="failed"> Failed</option>
                </select>
            </div>
            <div class="test-case-body" style="display: none;">
                <div class="test-objective">
                    <div class="test-objective-label">Test Objective</div>
                    <p>Verify that the system is protected against: <strong>Legitimate user&#39;s device becomes non-compliant and they are locked out of all corporate resources.</strong></p>
                </div>
                
                
                
                
                <div class="test-behavior">
                    
                    <div class="test-behavior-vulnerable">
                        <h5> Vulnerable Behavior</h5>
                        <p style="margin: 0; font-size: 0.9rem;">User should receive clear notification and grace period to remediate compliance issues.</p>
                    </div>
                    
                    
                </div>
                
                
                <div class="test-steps">
                    <h5> Detailed Replication Steps</h5>
                    
                    <ol>
                        
                        <li>Simulate device compliance failure (e.g., outdated OS, missing patch).</li>
                        
                        <li>Attempt to access corporate services.</li>
                        
                        <li>Verify grace period or fallback access mechanism exists.</li>
                        
                    </ol>
                    
                </div>
                
                
                
                <div class="test-expected">
                    <h5> Expected Results</h5>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Attack attempts should be blocked or detected</li>
                        <li>Security controls should function as designed</li>
                        <li>No sensitive information should be exposed</li>
                        
                        
                        <li> should be effective</li>
                        
                        <li> should be effective</li>
                        
                        
                    </ul>
                </div>
                
                <div class="test-tools">
                    
                    <span class="test-tool-tag">Burp Suite</span>
                    <span class="test-tool-tag">OWASP ZAP</span>
                    
                    
                    
                    
                    
                </div>
                
                <div class="test-notes no-print">
                    <label style="display: block; font-weight: 600; margin-bottom: 5px;"> Test Notes</label>
                    <textarea placeholder="Document test findings, evidence, and observations here..."></textarea>
                </div>
            </div>
        </div>
        
        
        
    </section>

        <!-- Footer -->
        <footer class="footer">
            <p>Generated by Threat Model Tool | 2026-01-24 21:13:21 UTC</p>
            <p>BYOD Access Architecture | TM-BYOD-ARCH v1.0</p>
        </footer>
    </main>

    <script>
        // ========== PRINT/PDF MODE FUNCTIONALITY ==========
        function togglePrintMode() {
            const body = document.body;
            const toggleBtn = document.getElementById('printModeToggle');
            const isPrintMode = body.classList.toggle('print-mode');
            
            if (isPrintMode) {
                // Entering print mode
                toggleBtn.classList.add('active');
                toggleBtn.querySelector('span').textContent = 'Exit Print Mode';
                
                // Reset all diagram transforms for static viewing
                document.querySelectorAll('.diagram-canvas').forEach(canvas => {
                    canvas.style.transform = 'none';
                });
                
                // Scroll to top
                window.scrollTo(0, 0);
                
                // Store the current scroll position for restoration
                sessionStorage.setItem('scrollPosBeforePrint', window.scrollY);
            } else {
                // Exiting print mode
                toggleBtn.classList.remove('active');
                toggleBtn.querySelector('span').textContent = 'Print Mode';
                
                // Restore scroll position if available
                const savedPos = sessionStorage.getItem('scrollPosBeforePrint');
                if (savedPos) {
                    window.scrollTo(0, parseInt(savedPos));
                }
            }
        }
        
        // Keyboard shortcut: Ctrl+P for print mode, Escape to exit
        document.addEventListener('keydown', function(e) {
            // Escape to exit print mode
            if (e.key === 'Escape' && document.body.classList.contains('print-mode')) {
                togglePrintMode();
            }
            // Ctrl+Shift+P to toggle print mode (avoid conflict with browser print)
            if (e.ctrlKey && e.shiftKey && e.key === 'P') {
                e.preventDefault();
                togglePrintMode();
            }
        });
        
        // Check URL parameter for print mode
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('print') === 'true' || urlParams.get('pdf') === 'true') {
                togglePrintMode();
            }
            renderMermaidDiagrams();
        });

        // ========== END PRINT/PDF MODE ==========

        // Mermaid initialization with high-quality rendering for horizontal layouts
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            maxTextSize: 100000,
            fontSize: 13,
            flowchart: { 
                useMaxWidth: true, 
                htmlLabels: true,
                rankSpacing: 50,
                nodeSpacing: 30,
                curve: 'basis',
                defaultRenderer: 'dagre-wrapper',
                wrappingWidth: 300,
                padding: 10,
                diagramPadding: 8
            },
            themeVariables: {
                fontSize: '13px',
                fontFamily: 'Arial, sans-serif',
                primaryColor: '#3498db',
                primaryTextColor: '#fff',
                primaryBorderColor: '#2980b9',
                lineColor: '#7f8c8d',
                secondaryColor: '#ecf0f1',
                tertiaryColor: '#f8f9fa'
            }
        });

        async function renderMermaidDiagrams() {
            const diagrams = Array.from(document.querySelectorAll('.mermaid'));
            if (!diagrams.length) {
                return;
            }
            if (!window.mermaid) {
                diagrams.forEach(el => {
                    el.innerHTML = '<div style="padding:12px; background:#fff3cd; color:#856404; border:1px solid #ffeeba; border-radius:6px; font-size:0.9rem;">Mermaid is not available. Please ensure the Mermaid CDN is reachable.</div>';
                });
                return;
            }

            for (const el of diagrams) {
                const source = el.textContent.trim();
                if (!source) {
                    el.innerHTML = '<div style="padding:12px; background:#fff3cd; color:#856404; border:1px solid #ffeeba; border-radius:6px; font-size:0.9rem;">Mermaid source was empty.</div>';
                    continue;
                }

                // Generate unique ID for Mermaid render (must be unique per render call)
                const baseId = el.getAttribute('data-diagram-id') || 'mermaid';
                const diagramId = `${baseId}-${Date.now()}-${Math.random().toString(36).slice(2)}`;
                try {
                    // Clear original text before rendering
                    el.innerHTML = '';

                    // Mermaid v10+ returns a Promise from render
                    const renderResult = mermaid.render(diagramId, source);
                    const { svg, bindFunctions } = (renderResult && typeof renderResult.then === 'function')
                        ? await renderResult
                        : renderResult;

                    el.innerHTML = svg;
                    if (typeof bindFunctions === 'function') {
                        bindFunctions(el);
                    }
                } catch (err) {
                    console.error('Mermaid render error:', err);
                    const pre = document.createElement('pre');
                    pre.style.whiteSpace = 'pre-wrap';
                    pre.style.background = '#fff3cd';
                    pre.style.color = '#856404';
                    pre.style.border = '1px solid #ffeeba';
                    pre.style.borderRadius = '6px';
                    pre.style.padding = '12px';
                    pre.textContent = 'Mermaid failed to render this diagram. Please check the diagram syntax in the source.';
                    el.innerHTML = '';
                    el.appendChild(pre);
                }
            }
        }
        
        // PlantUML rendering using online service
        // Store PUML source without HTML escaping (using tojson for proper JS string escaping)
        const pumlComponentSource = "@startuml\n\ntitle BYOD Access Architecture - Data Flow Diagram\n\n!define CRITICAL_COLOR #FF6B6B\n!define HIGH_COLOR #FFA500\n!define MEDIUM_COLOR #FFD93D\n!define LOW_COLOR #6BCB77\n!define TRUST_BOUNDARY_COLOR #E8E8E8\n\nskinparam {\n    BackgroundColor white\n    ArrowColor #333333\n    ArrowFontSize 10\n    ParticipantBorderColor #2c3e50\n    ParticipantBackgroundColor #ecf0f1\n    ParticipantFontColor #2c3e50\n    NoteBackgroundColor #fffde7\n    NoteBorderColor #ffc107\n    RectangleBorderColor #2c3e50\n    RectangleBorderStyle dashed\n}\n\n\u0027 === TRUST ZONES AND PARTICIPANTS ===\nrectangle \"Untrusted\" as zone_Untrusted \u003c\u003ctrust_zone\u003e\u003e {\n    component \"User Device (BYOD)\" as A_BYOD_DEVICE #f5c6cb\n}\n\nrectangle \"Corporate Cloud\" as zone_Corporate_Cloud \u003c\u003ctrust_zone\u003e\u003e {\n    component \"Identity Provider\" as A_IDP\n    component \"Device Management Platform\" as A_MDM\n    component \"Conditional Access Engine\" as A_COND_ACCESS\n    component \"Corporate Cloud Services\" as A_CORP_SERVICES\n    component \"Logging \u0026 Monitoring Platform\" as A_LOGGING\n}\n\nrectangle \"Managed Container\" as zone_Managed_Container \u003c\u003ctrust_zone\u003e\u003e {\n    component \"Endpoint Security Agent\" as A_ENDPOINT_SEC\n}\n\n\u0027 === DATA FLOWS ===\nA_IDP --\u003e A_COND_ACCESS : Identity Verification (Internal API)\nA_MDM --\u003e A_COND_ACCESS : Device Compliance Report (Internal API)\nA_COND_ACCESS --\u003e A_IDP : Access Decision (Internal API)\nA_CORP_SERVICES --\u003e A_LOGGING : Audit Logs (Syslog/API)\nA_BYOD_DEVICE -[#FF0000,bold]-\u003e A_IDP : \u003ccolor:red\u003e\u003cb\u003eAuthentication Request\u003c/b\u003e\u003c/color\u003e (HTTPS)\\n!! CROSSES BOUNDARY\nA_BYOD_DEVICE -[#FF0000,bold]-\u003e A_MDM : \u003ccolor:red\u003e\u003cb\u003eDevice Registration\u003c/b\u003e\u003c/color\u003e (HTTPS)\\n!! CROSSES BOUNDARY\nA_BYOD_DEVICE -[#FF0000,bold]-\u003e A_CORP_SERVICES : \u003ccolor:red\u003e\u003cb\u003eAccess Corporate Services\u003c/b\u003e\u003c/color\u003e (HTTPS)\\n!! CROSSES BOUNDARY\nA_IDP -[#FF0000,bold]-\u003e A_BYOD_DEVICE : \u003ccolor:red\u003e\u003cb\u003eIssue Access Token\u003c/b\u003e\u003c/color\u003e (HTTPS)\\n!! CROSSES BOUNDARY\nA_ENDPOINT_SEC -[#FF0000,bold]-\u003e A_MDM : \u003ccolor:red\u003e\u003cb\u003eCompliance Telemetry\u003c/b\u003e\u003c/color\u003e (HTTPS)\\n!! CROSSES BOUNDARY\n\n\u0027 === LEGEND ===\nlegend right\n    |= Color |= Meaning |\n    | \u003cback:CRITICAL_COLOR\u003e    \u003c/back\u003e | Critical Risk (CVSS 9.0+) |\n    | \u003cback:HIGH_COLOR\u003e    \u003c/back\u003e | High Risk (CVSS 7.0-8.9) |\n    | \u003cback:MEDIUM_COLOR\u003e    \u003c/back\u003e | Medium Risk (CVSS 4.0-6.9) |\n    | \u003cback:LOW_COLOR\u003e    \u003c/back\u003e | Low Risk (CVSS \u003c 4.0) |\n    | \u003ccolor:red\u003e\u2014\u2014\u003e\u003c/color\u003e | Crosses Trust Boundary |\n    | \u003ccolor:orange\u003e\u2014\u2014\u003e\u003c/color\u003e | Sensitive Data Flow |\nendlegend\n\nfooter Generated from TM-BYOD-ARCH v1.0\n\n@enduml";
        const pumlSequenceSource = "@startuml\n\ntitle BYOD Access Architecture - Dataflow Sequence\n\nskinparam {\n    ParticipantBorderColor #2c3e50\n    ParticipantBackgroundColor #ecf0f1\n    SequenceArrowColor #333333\n    SequenceLifeLineBorderColor #bdc3c7\n    NoteBackgroundColor #fff3cd\n    NoteBorderColor #ffc107\n}\n\nbox \"Untrusted\" #f8d7da\n    participant \"User Device (BYOD)\" as A_BYOD_DEVICE\nend box\n\nbox \"Corporate Cloud\" #d4edda\n    participant \"Identity Provider\" as A_IDP\n    participant \"Device Management Platform\" as A_MDM\n    participant \"Conditional Access Engine\" as A_COND_ACCESS\n    participant \"Corporate Cloud Services\" as A_CORP_SERVICES\n    database \"Logging \u0026 Monitoring Platform\" as A_LOGGING\nend box\n\nbox \"Managed Container\" #d4edda\n    participant \"Endpoint Security Agent\" as A_ENDPOINT_SEC\nend box\n\n== Data Flow Interactions ==\n\nA_BYOD_DEVICE -[#FF0000]\u003e A_CORP_SERVICES: \u003ccolor:red\u003e\u003cb\u003eAccess Corporate Services\u003c/b\u003e\u003c/color\u003e\\n(HTTPS)\nnote right #FFCCCC\n    **\u26a0 CROSSES TRUST BOUNDARY**\n    Classification: Confidential\nend note\nA_BYOD_DEVICE -[#FF0000]\u003e A_IDP: \u003ccolor:red\u003e\u003cb\u003eAuthentication Request\u003c/b\u003e\u003c/color\u003e\\n(HTTPS)\nnote right #FFCCCC\n    **\u26a0 CROSSES TRUST BOUNDARY**\n    Classification: Restricted\nend note\nA_BYOD_DEVICE -[#FF0000]\u003e A_MDM: \u003ccolor:red\u003e\u003cb\u003eDevice Registration\u003c/b\u003e\u003c/color\u003e\\n(HTTPS)\nnote right #FFCCCC\n    **\u26a0 CROSSES TRUST BOUNDARY**\n    Classification: Internal\nend note\nA_IDP -[#FF0000]\u003e A_BYOD_DEVICE: \u003ccolor:red\u003e\u003cb\u003eIssue Access Token\u003c/b\u003e\u003c/color\u003e\\n(HTTPS)\nnote right #FFCCCC\n    **\u26a0 CROSSES TRUST BOUNDARY**\n    Classification: Restricted\nend note\nA_ENDPOINT_SEC -[#FF0000]\u003e A_MDM: \u003ccolor:red\u003e\u003cb\u003eCompliance Telemetry\u003c/b\u003e\u003c/color\u003e\\n(HTTPS)\nnote right #FFCCCC\n    **\u26a0 CROSSES TRUST BOUNDARY**\n    Classification: Internal\nend note\nA_IDP -\u003e A_COND_ACCESS: Identity Verification\\n(Internal API)\nA_MDM -\u003e A_COND_ACCESS: Device Compliance Report\\n(Internal API)\nA_COND_ACCESS -\u003e A_IDP: Access Decision\\n(Internal API)\nA_CORP_SERVICES -\u003e A_LOGGING: Audit Logs\\n(Syslog/API)\n\nfooter Model: TM-BYOD-ARCH | Version: 1.0\n\n@enduml";
        
        console.log('PUML Component Source loaded:', pumlComponentSource ? pumlComponentSource.substring(0, 100) + '...' : 'empty');
        console.log('PUML Sequence Source loaded:', pumlSequenceSource ? pumlSequenceSource.substring(0, 100) + '...' : 'empty');
        
        function encodePlantUML(puml) {
            // PlantUML text encoding (similar to base64 but custom)
            function encode64(data) {
                let r = "";
                for (let i = 0; i < data.length; i += 3) {
                    if (i + 2 === data.length) {
                        r += append3bytes(data[i], data[i+1], 0);
                    } else if (i + 1 === data.length) {
                        r += append3bytes(data[i], 0, 0);
                    } else {
                        r += append3bytes(data[i], data[i+1], data[i+2]);
                    }
                }
                return r;
            }
            
            function append3bytes(b1, b2, b3) {
                let c1 = b1 >> 2;
                let c2 = ((b1 & 0x3) << 4) | (b2 >> 4);
                let c3 = ((b2 & 0xF) << 2) | (b3 >> 6);
                let c4 = b3 & 0x3F;
                let r = "";
                r += encode6bit(c1 & 0x3F);
                r += encode6bit(c2 & 0x3F);
                r += encode6bit(c3 & 0x3F);
                r += encode6bit(c4 & 0x3F);
                return r;
            }
            
            function encode6bit(b) {
                if (b < 10) return String.fromCharCode(48 + b);
                b -= 10;
                if (b < 26) return String.fromCharCode(65 + b);
                b -= 26;
                if (b < 26) return String.fromCharCode(97 + b);
                b -= 26;
                if (b === 0) return '-';
                if (b === 1) return '_';
                return '?';
            }
            
            // properly handle encoding for pako 2.x which uses Uint8Array
            const encoder = new TextEncoder();
            const data = encoder.encode(puml);
            
            if (window.pako && window.pako.deflateRaw) {
                try {
                    const deflated = window.pako.deflateRaw(data); // returns Uint8Array
                    return encode64(deflated);
                } catch(e) {
                    console.error('Pako error:', e);
                    return "";
                }
            } else {
                console.warn('Pako not loaded, cannot compress PlantUML source.');
                return "";
            }
        }
        
        // Load pako for deflate compression
        function loadPako(callback) {
            if (window.pako) {
                callback();
                return;
            }
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js';
            script.onload = callback;
            script.onerror = function() {
                console.warn('Pako not loaded, PlantUML diagrams may not render');
                callback();
            };
            document.head.appendChild(script);
        }
        
        function renderPlantUMLDiagrams() {
            console.log('Starting PlantUML rendering...');
            loadPako(function() {
                console.log('Pako loaded:', !!window.pako);
                
                // Render component diagram
                if (pumlComponentSource && pumlComponentSource.trim().length > 0) {
                    console.log('Rendering component diagram...');
                    try {
                        const encodedComponent = encodePlantUML(pumlComponentSource);
                        const url = 'https://www.plantuml.com/plantuml/svg/' + encodedComponent;
                        console.log('Component diagram URL:', url.substring(0, 100) + '...');
                        
                        const componentImg = document.getElementById('puml-component-img');
                        if (componentImg) {
                            componentImg.src = url;
                            componentImg.onload = function() {
                                console.log('Component diagram loaded successfully');
                            };
                            componentImg.onerror = function(e) {
                                console.error('Failed to load component diagram:', e);
                                this.alt = 'Failed to render PlantUML diagram. Try copying the source and using a local PlantUML renderer.';
                                this.style.background = '#fff3cd';
                                this.style.padding = '20px';
                                this.style.color = '#856404';
                            };
                        }
                    } catch (e) {
                        console.error('Error encoding component PUML:', e);
                    }
                } else {
                    console.warn('No component PUML source available');
                }
                
                // Render sequence diagram
                if (pumlSequenceSource && pumlSequenceSource.trim().length > 0) {
                    console.log('Rendering sequence diagram...');
                    try {
                        const encodedSequence = encodePlantUML(pumlSequenceSource);
                        const url = 'https://www.plantuml.com/plantuml/svg/' + encodedSequence;
                        console.log('Sequence diagram URL:', url.substring(0, 100) + '...');
                        
                        const sequenceImg = document.getElementById('puml-sequence-img');
                        if (sequenceImg) {
                            sequenceImg.src = url;
                            sequenceImg.onload = function() {
                                console.log('Sequence diagram loaded successfully');
                            };
                            sequenceImg.onerror = function(e) {
                                console.error('Failed to load sequence diagram:', e);
                                this.alt = 'Failed to render PlantUML diagram. Try copying the source and using a local PlantUML renderer.';
                                this.style.background = '#fff3cd';
                                this.style.padding = '20px';
                                this.style.color = '#856404';
                            };
                        }
                    } catch (e) {
                        console.error('Error encoding sequence PUML:', e);
                    }
                } else {
                    console.warn('No sequence PUML source available');
                }
            });
        }
        
        // Tab switching for PlantUML views
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // Update tab buttons
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Update tab content
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                document.getElementById(tabId).classList.add('active');

                // Refit diagrams in the active tab to maximize zoom
                const activeContent = document.getElementById(tabId);
                if (activeContent) {
                    const diagrams = activeContent.querySelectorAll('.interactive-diagram');
                    diagrams.forEach(diagram => {
                        const controller = diagram._diagramController;
                        if (controller && typeof controller.fitToView === 'function') {
                            setTimeout(() => controller.fitToView(), 50);
                        }
                    });
                }
            });
        });
        
        // Source tab switching
        document.querySelectorAll('.source-tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const sourceId = this.dataset.source;
                
                // Update source tab buttons
                document.querySelectorAll('.source-tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Update source content
                document.querySelectorAll('.source-content').forEach(c => c.classList.remove('active'));
                document.getElementById('source-' + sourceId).classList.add('active');
            });
        });
        
        // Copy PlantUML source to clipboard
        function copyPumlSource(type) {
            const source = type === 'component' ? pumlComponentSource : pumlSequenceSource;
            navigator.clipboard.writeText(source).then(function() {
                alert('PlantUML source copied to clipboard!');
            }).catch(function(err) {
                console.error('Failed to copy: ', err);
                // Fallback: select text
                const sourceEl = document.querySelector('#source-' + type + ' code');
                if (sourceEl) {
                    const range = document.createRange();
                    range.selectNode(sourceEl);
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                }
            });
        }
        
        // Initialize PlantUML rendering on page load
        document.addEventListener('DOMContentLoaded', renderPlantUMLDiagrams);
        
        // ========== SECURITY TESTING FUNCTIONALITY ==========
        function toggleTestCase(header) {
            const body = header.nextElementSibling;
            const isVisible = body.style.display !== 'none';
            body.style.display = isVisible ? 'none' : 'block';
        }
        
        function copyTestScript(button, scriptId) {
            const codeElement = document.getElementById('script-' + scriptId);
            const code = codeElement.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = ' Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert('Failed to copy script to clipboard');
            });
        }
        
        function updateTestStatus(select, threatId) {
            const newStatus = select.value;
            const card = document.getElementById('test-' + threatId);
            const oldStatus = card.dataset.testStatus;
            
            // Update card status
            card.dataset.testStatus = newStatus;
            
            // Update select styling
            select.className = 'test-status-select ' + newStatus + ' no-print';
            
            // Update counters
            updateTestingCounters(oldStatus, newStatus);
        }
        
        function updateTestingCounters(oldStatus, newStatus) {
            const passedEl = document.getElementById('test-passed');
            const failedEl = document.getElementById('test-failed');
            const pendingEl = document.getElementById('test-pending');
            
            let passed = parseInt(passedEl.textContent);
            let failed = parseInt(failedEl.textContent);
            let pending = parseInt(pendingEl.textContent);
            
            // Decrement old status count
            if (oldStatus === 'passed') passed--;
            else if (oldStatus === 'failed') failed--;
            else if (oldStatus === 'not-tested' || oldStatus === 'in-progress') pending--;
            
            // Increment new status count
            if (newStatus === 'passed') passed++;
            else if (newStatus === 'failed') failed++;
            else if (newStatus === 'not-tested' || newStatus === 'in-progress') pending++;
            
            passedEl.textContent = passed;
            failedEl.textContent = failed;
            pendingEl.textContent = pending;
        }
        
        // Sidebar navigation toggle
        function toggleSection(header) {
            const section = header.closest('.nav-section');
            section.classList.toggle('expanded');
        }
        
        // Threat group accordion toggle (only one open at a time)
        function toggleThreatGroup(header) {
            const group = header.closest('.nav-threat-group');
            const isExpanded = group.classList.contains('expanded');
            
            // Close all other threat groups
            document.querySelectorAll('.nav-threat-group.expanded').forEach(g => {
                g.classList.remove('expanded');
            });
            
            // Toggle clicked group (open if it was closed)
            if (!isExpanded) {
                group.classList.add('expanded');
            }
        }
        
        // Highlight current section on scroll
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item, .nav-threat-item');
            const sections = document.querySelectorAll('section[id], .threat-card[id], h3[id]');
            
            function updateActiveNav() {
                let currentSection = '';
                const scrollPos = window.scrollY + 100;
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (scrollPos >= sectionTop) {
                        currentSection = section.getAttribute('id');
                    }
                });
                
                navItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('href') === '#' + currentSection) {
                        item.classList.add('active');
                        // Auto-expand the threat group if a threat is active
                        const group = item.closest('.nav-threat-group');
                        if (group && !group.classList.contains('expanded')) {
                            document.querySelectorAll('.nav-threat-group.expanded').forEach(g => {
                                g.classList.remove('expanded');
                            });
                            group.classList.add('expanded');
                        }
                    }
                });
            }
            
            window.addEventListener('scroll', updateActiveNav);
            updateActiveNav();
            
            // Smooth scroll for nav items
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });
        });
    </script>
    
    
<script>
/**
 * Interactive Diagram Controller
 * Provides zoom, pan, fullscreen, and node inspection for diagrams.
 * Automatically initializes all elements with class 'interactive-diagram'.
 */
(function() {
    'use strict';
    
    // Configuration
    const CONFIG = {
        minZoom: 0.1,
        maxZoom: 5,
        zoomStep: 0.25,
        wheelZoomFactor: 0.001,
        animationDuration: 200
    };
    
    /**
     * DiagramController class - manages a single interactive diagram
     */
    class DiagramController {
        constructor(container) {
            this.container = container;
            this.viewport = container.querySelector('.diagram-viewport');
            this.canvas = container.querySelector('.diagram-canvas');
            this.zoomDisplay = container.querySelector('.zoom-level');
            this.diagramType = container.dataset.diagramType || 'unknown';
            this.diagramTitle = container.dataset.diagramTitle || 'Diagram';
            this.contentType = container.dataset.contentType || 'mermaid';
            
            // State
            this.scale = 1;
            this.translateX = 0;
            this.translateY = 0;
            this.isPanning = false;
            this.startX = 0;
            this.startY = 0;
            this.isFullscreen = false;
            this.initialized = false;
            
            this.init();
        }
        
        init() {
            if (!this.viewport || !this.canvas) {
                console.warn('DiagramController: Missing viewport or canvas');
                return;
            }
            
            this.bindToolbarEvents();
            this.bindPanEvents();
            this.bindWheelZoom();
            this.bindKeyboardEvents();
            this.bindTouchEvents();
            this.setupNodeInspection();
            
            // Mark as initialized
            this.container._diagramController = this;
            this.initialized = true;
            
            // Fit to view once content is ready
            this.waitForContent().then(() => this.fitToView());
        }
        
        waitForContent() {
            return new Promise(resolve => {
                const check = () => {
                    const content = this.canvas.querySelector('svg, img[src]:not([src=""])');
                    if (content) {
                        // For images, wait until loaded
                        if (content.tagName === 'IMG' && !content.complete) {
                            content.addEventListener('load', resolve, { once: true });
                            content.addEventListener('error', resolve, { once: true });
                        } else {
                            resolve();
                        }
                    } else {
                        setTimeout(check, 100);
                    }
                };
                setTimeout(check, 100);
            });
        }
        
        updateTransform(animate = false) {
            if (animate) {
                this.canvas.classList.add('animating');
                setTimeout(() => this.canvas.classList.remove('animating'), CONFIG.animationDuration);
            }
            this.canvas.style.transform = `translate(${this.translateX}px, ${this.translateY}px) scale(${this.scale})`;
            if (this.zoomDisplay) {
                this.zoomDisplay.textContent = Math.round(this.scale * 100) + '%';
            }
        }
        
        zoomTo(newScale, centerX = null, centerY = null) {
            const oldScale = this.scale;
            newScale = Math.max(CONFIG.minZoom, Math.min(CONFIG.maxZoom, newScale));
            
            if (centerX !== null && centerY !== null) {
                const viewportRect = this.viewport.getBoundingClientRect();
                const relX = centerX - viewportRect.left;
                const relY = centerY - viewportRect.top;
                this.translateX = relX - (relX - this.translateX) * (newScale / oldScale);
                this.translateY = relY - (relY - this.translateY) * (newScale / oldScale);
            }
            
            this.scale = newScale;
            this.updateTransform();
        }
        
        zoomIn() { this.zoomTo(this.scale + CONFIG.zoomStep); }
        zoomOut() { this.zoomTo(this.scale - CONFIG.zoomStep); }
        
        reset() {
            this.scale = 1;
            this.translateX = 0;
            this.translateY = 0;
            this.updateTransform(true);
        }
        
        fitToView() {
            const viewportRect = this.viewport.getBoundingClientRect();
            const content = this.canvas.querySelector('svg, img');
            
            if (!content) return;
            
            this.canvas.style.transform = 'none';
            
            let contentWidth, contentHeight, contentX = 0, contentY = 0;
            if (content.tagName === 'svg') {
                const bbox = content.getBBox ? content.getBBox() : content.getBoundingClientRect();
                contentWidth = bbox.width || content.clientWidth;
                contentHeight = bbox.height || content.clientHeight;
                contentX = bbox.x || 0;
                contentY = bbox.y || 0;
            } else {
                contentWidth = content.naturalWidth || content.width;
                contentHeight = content.naturalHeight || content.height;
            }
            
            if (!contentWidth || !contentHeight) {
                this.canvas.style.transform = `translate(${this.translateX}px, ${this.translateY}px) scale(${this.scale})`;
                return;
            }
            
            const padding = Math.max(16, Math.min(40, viewportRect.width * 0.05));
            const availableWidth = viewportRect.width - padding * 2;
            const availableHeight = viewportRect.height - padding * 2;
            
            const scaleX = availableWidth / contentWidth;
            const scaleY = availableHeight / contentHeight;
            const newScale = Math.min(scaleX, scaleY);
            
            this.scale = Math.max(CONFIG.minZoom, Math.min(CONFIG.maxZoom, newScale));
            this.translateX = padding - (contentX * this.scale);
            this.translateY = padding - (contentY * this.scale);
            
            this.updateTransform(true);
        }
        
        toggleFullscreen() {
            this.isFullscreen = !this.isFullscreen;
            this.viewport.classList.toggle('fullscreen', this.isFullscreen);
            
            const fsBtn = this.container.querySelector('[data-action="fullscreen"]');
            if (fsBtn) fsBtn.classList.toggle('active', this.isFullscreen);
            
            document.body.style.overflow = this.isFullscreen ? 'hidden' : '';
            
            if (this.isFullscreen) {
                setTimeout(() => this.fitToView(), 100);
            }
        }
        
        bindToolbarEvents() {
            this.container.querySelectorAll('[data-action]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const action = btn.dataset.action;
                    switch (action) {
                        case 'zoom-in': this.zoomIn(); break;
                        case 'zoom-out': this.zoomOut(); break;
                        case 'reset': this.reset(); break;
                        case 'fit': this.fitToView(); break;
                        case 'fullscreen':
                        case 'exit-fullscreen':
                            this.toggleFullscreen();
                            break;
                    }
                });
            });
        }
        
        bindPanEvents() {
            this.viewport.addEventListener('mousedown', (e) => {
                if (e.button !== 0) return;
                this.isPanning = true;
                this.startX = e.clientX - this.translateX;
                this.startY = e.clientY - this.translateY;
                this.viewport.classList.add('grabbing');
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!this.isPanning) return;
                this.translateX = e.clientX - this.startX;
                this.translateY = e.clientY - this.startY;
                this.updateTransform();
            });
            
            document.addEventListener('mouseup', () => {
                this.isPanning = false;
                this.viewport.classList.remove('grabbing');
            });
        }
        
        bindWheelZoom() {
            this.viewport.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = -e.deltaY * CONFIG.wheelZoomFactor * this.scale;
                this.zoomTo(this.scale + delta, e.clientX, e.clientY);
            }, { passive: false });
        }
        
        bindKeyboardEvents() {
            this.container.setAttribute('tabindex', '0');
            this.container.addEventListener('keydown', (e) => {
                switch (e.key) {
                    case '+': case '=': this.zoomIn(); e.preventDefault(); break;
                    case '-': this.zoomOut(); e.preventDefault(); break;
                    case '0': this.reset(); e.preventDefault(); break;
                    case 'f': case 'F': this.toggleFullscreen(); e.preventDefault(); break;
                    case 'Escape':
                        if (this.isFullscreen) { this.toggleFullscreen(); e.preventDefault(); }
                        break;
                }
            });
        }
        
        bindTouchEvents() {
            let lastTouchDist = 0;
            
            this.viewport.addEventListener('touchstart', (e) => {
                if (e.touches.length === 1) {
                    this.isPanning = true;
                    this.startX = e.touches[0].clientX - this.translateX;
                    this.startY = e.touches[0].clientY - this.translateY;
                } else if (e.touches.length === 2) {
                    this.isPanning = false;
                    lastTouchDist = this.getTouchDistance(e.touches);
                }
            }, { passive: true });
            
            this.viewport.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1 && this.isPanning) {
                    this.translateX = e.touches[0].clientX - this.startX;
                    this.translateY = e.touches[0].clientY - this.startY;
                    this.updateTransform();
                } else if (e.touches.length === 2) {
                    const newDist = this.getTouchDistance(e.touches);
                    const center = this.getTouchCenter(e.touches);
                    this.zoomTo(this.scale * (newDist / lastTouchDist), center.x, center.y);
                    lastTouchDist = newDist;
                }
                e.preventDefault();
            }, { passive: false });
            
            this.viewport.addEventListener('touchend', () => { this.isPanning = false; });
        }
        
        getTouchDistance(touches) {
            const dx = touches[0].clientX - touches[1].clientX;
            const dy = touches[0].clientY - touches[1].clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        getTouchCenter(touches) {
            return {
                x: (touches[0].clientX + touches[1].clientX) / 2,
                y: (touches[0].clientY + touches[1].clientY) / 2
            };
        }
        
        setupNodeInspection() {
            // Create shared tooltip
            if (!document.getElementById('diagram-tooltip')) {
                const tooltip = document.createElement('div');
                tooltip.id = 'diagram-tooltip';
                tooltip.className = 'diagram-tooltip';
                document.body.appendChild(tooltip);
            }
            
            const tooltip = document.getElementById('diagram-tooltip');
            
            // Observe for SVG content
            const observer = new MutationObserver(() => {
                const svg = this.canvas.querySelector('svg');
                if (svg) {
                    this.attachNodeListeners(svg, tooltip);
                    observer.disconnect();
                }
            });
            
            observer.observe(this.canvas, { childList: true, subtree: true });
            
            const svg = this.canvas.querySelector('svg');
            if (svg) this.attachNodeListeners(svg, tooltip);
        }
        
        attachNodeListeners(svg, tooltip) {
            const nodes = svg.querySelectorAll('.node, g[id^="flowchart-"], g[id^="T_"], g[id^="A_"], g[id^="M_"], g[id="ROOT"]');
            
            nodes.forEach(node => {
                node.style.cursor = 'pointer';
                
                node.addEventListener('mouseenter', () => {
                    const nodeId = node.id || '';
                    const nodeText = node.textContent.trim().substring(0, 100);
                    const meta = this.extractNodeMeta(nodeId, nodeText);
                    
                    if (meta.title) {
                        tooltip.innerHTML = `
                            <div class="tooltip-title">${meta.title}</div>
                            ${meta.type ? `<div class="tooltip-meta">Type: ${meta.type}</div>` : ''}
                            ${meta.id ? `<div class="tooltip-meta">ID: ${meta.id}</div>` : ''}
                        `;
                        tooltip.classList.add('visible');
                    }
                });
                
                node.addEventListener('mousemove', (e) => {
                    tooltip.style.left = (e.clientX + 15) + 'px';
                    tooltip.style.top = (e.clientY + 15) + 'px';
                });
                
                node.addEventListener('mouseleave', () => {
                    tooltip.classList.remove('visible');
                });
                
                node.addEventListener('click', () => {
                    const nodeId = node.id || '';
                    if (nodeId.startsWith('T_')) {
                        const threatId = nodeId.replace('T_', '');
                        const threatEl = document.getElementById('threat-' + threatId);
                        if (threatEl) {
                            threatEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            threatEl.classList.add('highlight');
                            setTimeout(() => threatEl.classList.remove('highlight'), 2000);
                        }
                    }
                });
            });
        }
        
        extractNodeMeta(nodeId, nodeText) {
            let meta = { title: nodeText.substring(0, 60), type: null, id: null };
            
            if (nodeId.startsWith('T_')) {
                meta.type = 'Threat';
                meta.id = nodeId.replace('T_', '');
            } else if (nodeId.startsWith('A_')) {
                meta.type = 'Asset';
                meta.id = nodeId.replace('A_', '');
            } else if (nodeId.startsWith('M_')) {
                meta.type = 'Mitigation';
                meta.id = nodeId.replace('M_', '');
            } else if (nodeId === 'ROOT') {
                meta.type = 'Threat Model Root';
            }
            
            return meta;
        }
    }
    
    /**
     * Initialize all interactive diagrams on the page.
     * Called automatically on DOMContentLoaded.
     */
    function initInteractiveDiagrams() {
        document.querySelectorAll('.interactive-diagram').forEach(container => {
            if (!container._diagramController) {
                new DiagramController(container);
            }
        });
    }
    
    // Auto-initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initInteractiveDiagrams, 500);
        });
    } else {
        setTimeout(initInteractiveDiagrams, 500);
    }
    
    // Export for manual initialization
    window.DiagramController = DiagramController;
    window.initInteractiveDiagrams = initInteractiveDiagrams;
})();
</script>

</body>
</html>